(function(e){function t(t){for(var n,i,c=t[0],s=t[1],u=t[2],d=0,p=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);l&&l(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,c=1;c<r.length;c++){var s=r[c];0!==a[s]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={app:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/offline-recorder/dist/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"29d8":function(e,t,r){"use strict";r("9a51")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("h1",[e._v("离线录制")]),r("h4",[e._v("一款直接在浏览器中运行的录音机，数据离线实时保存（尚未适配手机）")]),r("div",{staticClass:"inner-card"},[r("el-collapse",{attrs:{accordion:""},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[r("el-collapse-item",{attrs:{name:"1"}},[r("template",{slot:"title"},[r("div",{staticStyle:{"padding-left":"2rem"}},[e._v("功能")])]),r("h3",[e._v(" 断电，关闭浏览器或录音时间过长超出内存等问题，都不丢失数据，重新打开继续录 ")]),r("h3",[e._v("数据保存在浏览器中，存储在本地电脑上，保护隐私")]),r("h3",[e._v("支持同时录多份录音文件，不会出现不下载就消失的情况")]),r("h3",[e._v("在线播放器，可在线预览，选择下载")]),r("h3",[e._v("自动记录额外信息，如录音时间段，长度大小等")]),r("h3",[e._v(' 可添加为WebApp（打开Chrome浏览器点击地址栏右侧“安装recorder"，手机可打开手机版Chrome后，根据底部提示操作） ')])],2),r("el-collapse-item",{attrs:{name:"2"}},[r("template",{slot:"title"},[r("div",{staticStyle:{"padding-left":"2rem"}},[e._v("注意事项")])]),r("h3",[e._v(" 切记本录音机不能在同一浏览器上同时打开两个，否则会造成存储混乱，对数据产生不可预测破坏 ")]),r("h3",[e._v("请勿清除浏览器记录，录音文件及时下载防止丢失")]),r("h3",[e._v(" 录音占用空间过大或一次录音时间过长时可能发生存储加载延迟，出现播放列表短暂不显示，等待一段时间即可 ")]),r("h3",[e._v("请不要在一个录音中使用多个源（目前版本），例如如果录屏，就一直使用录屏的视频源，中断后继续时也一样，不要切换到摄像头")])],2)],1)],1),r("div",{staticStyle:{"margin-top":"2rem"}}),r("div",[r("router-view")],1)])},o=[],i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"cont",staticClass:"container",staticStyle:{background:"green"},style:{left:e.x+"px",top:e.y+"px"},on:{mouseover:function(t){return e.enter(t)},mouseout:function(t){return e.leave(t)},mousedown:function(t){return e.down(t)}}},[e._t("default")],2)},c=[],s={data:function(){return{x:0,y:0,beforeDrag:!1,draging:!1,dragX:0,dragY:0}},mounted:function(){var e=this;document.addEventListener("mousemove",(function(t){return e.move(t)})),document.addEventListener("mouseup",(function(t){return e.up(t)}))},methods:{isdrag:function(e){var t=e.target.dataset["draggable"];return!!t},enter:function(e){this.draging||this.isdrag(e)&&(this.beforeDrag=!0,this.draging=!1)},leave:function(e){this.draging||this.isdrag(e)&&(this.beforeDrag=!1,this.draging=!1)},move:function(e){this.draging&&(this.x=e.clientX-this.dragX,this.y=e.clientY-this.dragY,console.log(this.dragX,this.dragY))},down:function(e){if(e.currentTarget==this.$refs["cont"]){var t=e.currentTarget.getBoundingClientRect();this.dragX=e.clientX-t.left,this.dragY=e.clientY-t.top,console.log(this.dragX,this.dragY)}this.isdrag(e)&&this.beforeDrag&&(this.beforeDrag=!1,this.draging=!0)},up:function(e){this.draging&&(this.beforeDrag=!0,this.draging=!1),this.effect()},effect:function(){this.x<0&&(this.x=0),Math.abs(this.x)<20&&(this.x=0),Math.abs(this.y)<20&&(this.x=0)}}},u=s,l=(r("29d8"),r("2877")),d=Object(l["a"])(u,i,c,!1,null,"487e012f",null),p=d.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",[r("el-form-item",{attrs:{label:"媒体源"}},[r("el-select",{on:{select:e.select},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.medianames,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1)],1)},m=[],h=r("1da1"),b=(r("96cf"),{props:{value:{type:String,default:""}},data:function(){return{selected:"",medianames:[{name:"麦克风（音频）",value:"mic"},{name:"摄像头（视频+音频）",value:"capture"},{name:"录屏(视频+电脑内音频）",value:"screen"},{name:"内部音源(电脑内音频）",value:"audiooutput"}],typemap:{mic:"audio",capture:"video",screen:"video",audiooutput:"audio"}}},watch:{value:function(){this.selected=this.value},selected:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$emit("update:value",e.selected),e.$emit("select");case 2:case"end":return t.stop()}}),t)})))()}},methods:{select:function(){this.$emit("select")},getSelectedStream:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getMediaStream(e.selected);case 2:if(r=t.sent,null!=r){t.next=5;break}return t.abrupt("return",null);case 5:return t.abrupt("return",{stream:r,name:e.selected,type:e.typemap[e.selected]});case 6:case"end":return t.stop()}}),t)})))()},getMediaStream:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n={mic:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getUserMedia({audio:!0,video:!1}));case 1:case"end":return e.stop()}}),e)})))()},capture:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getUserMedia({audio:!0,video:!0}));case 1:case"end":return e.stop()}}),e)})))()},screen:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}));case 1:case"end":return e.stop()}}),e)})))()},audiooutput:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}));case 1:case"end":return e.stop()}}),e)})))()}},e in n!==!1){r.next=3;break}return r.abrupt("return",null);case 3:return r.prev=3,r.next=6,n[e]();case 6:return r.abrupt("return",r.sent);case 9:return r.prev=9,r.t0=r["catch"](3),t.$message.error("此媒体源不可用，请切换媒体源"),r.abrupt("return",null);case 13:case"end":return r.stop()}}),r,null,[[3,9]])})))()}}}),v=b,w=Object(l["a"])(v,f,m,!1,null,null,null),g=w.exports,y={components:{GWidget:p,SelectSource:g},name:"App",data:function(){return{active:"2"}}},x=y,R=(r("b044"),Object(l["a"])(x,a,o,!1,null,null,null)),k=R.exports,O=r("5c96"),j=(r("0fae"),r("4380")),_=r("ead5"),I=r.n(_),S=r("3003"),T=r("9483");Object(T["a"])("".concat("/offline-recorder/dist/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var N=r("2f62"),M=r("2ef0"),B=r.n(M),E=r("5530"),$=r("d4ec"),D=r("bee2"),H=r("ade3"),C=(r("b0c0"),r("ec26")),U=r("3ad6"),L=r("5a0c"),P=r.n(L),Y=r("2bd2");function A(){return{id:"record_".concat(Object(C["a"])()),name:"record_".concat(P()().format("YYYY-MM-DD HH:mm:ss")),startTime:new Date,endTime:new Date,points:[]}}function z(e){var t=V();return t.type="pause",t.data={pause_type:e,time:new Date},t}function V(){return{type:"point",data:null}}var F=function(){function e(){Object($["a"])(this,e),Object(H["a"])(this,"recorder",null),Object(H["a"])(this,"onDataAvailable",new Y["a"])}return Object(D["a"])(e,[{key:"ensureinit",value:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==this.recorder){e.next=2;break}return e.abrupt("return");case 2:return t=navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),e.t0=MediaRecorder,e.next=6,t;case 6:e.t1=e.sent,e.t2={bitsPerSecond:128e3,audioBitrateMode:"variable",mimeType:"audio/webm"},r=new e.t0(e.t1,e.t2),this.recorder=r,r.addEventListener("dataavailable",(function(e){return n.onDataAvailable.next(e.data)}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),X=new F,J=null,q=function(){return{state:{mergedBlob:null,blobs:[],state:"normal",recordingInfo:null},mutations:{mergeBlob:function(e){e.mergedBlob=new Blob(e.blobs),e.blobs=[]},pushBlob:function(e,t){console.log("receive"),"recording"==e.state?e.blobs.push(t):console.error("状态错误，丢弃1帧")},addCheckPoint:function(e,t){if(null==e.recordingInfo)throw new Error("录制信息不存在，可能还没开始录音");e.recordingInfo.points.push(t)},setRecordingName:function(e,t){e.recordingInfo.name=t},switchState:function(e,t){switch(e.state){case"normal":"start"==t?(e.state="recording",e.recordingInfo=A()):Object(U["error"])("state和action不匹配");break;case"recording":if("pause"==t){e.state="paused";var r=z("pause");e.recordingInfo.points.push(r)}else"stop"==t?e.state="stopped":Object(U["error"])("state和action不匹配");break;case"paused":"stop"==t?e.state="stopped":"start"==t?(e.state="recording",e.recordingInfo.points.push(z("pause_resume"))):Object(U["error"])("state和action不匹配");break;case"stopped":"recover"==t?(e.state="normal",e.blobs=[],e.recordingInfo=null,e.mergedBlob=null):Object(U["error"])("state和action不匹配");break}}},getters:{recordingLength:function(e){return null==e.recordingInfo?null:e.blobs.length},historyBlobs:function(e){}},actions:{newRecorder:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},startNew:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,X.ensureinit();case 2:"normal"==e.state.state?(e.commit("switchState","start"),J=X.onDataAvailable.subscribe((function(t){e.commit("pushBlob",t)})),X.recorder.start(1e3)):Object(U["error"])("还没恢复到未开始状态");case 3:case"end":return t.stop()}}),t)})))()},resume:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,X.ensureinit();case 2:if("paused"==e.state.state){t.next=5;break}return Object(U["error"])("并非在暂停状态，调用resume"),t.abrupt("return");case 5:e.commit("switchState","start"),X.recorder.resume();case 7:case"end":return t.stop()}}),t)})))()},pause:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit("switchState","pause"),t.next=3,X.ensureinit();case 3:X.recorder.pause();case 4:case"end":return t.stop()}}),t)})))()},saveRecording:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.commit("switchState","stop"),r.next=3,X.ensureinit();case 3:return X.recorder.stop(),J.unsubscribe(),J=null,null!=t&&e.commit("setRecordingName",t),r.next=9,e.dispatch("storeToDisk");case 9:e.dispatch("tempcache/clearCache",null,{root:!0}),e.commit("switchState","recover");case 11:case"end":return r.stop()}}),r)})))()},storeToDisk:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return null==e.state.mergedBlob&&e.commit("mergeBlob"),t.next=3,e.dispatch("history/ensureInitHistory",null,{root:!0});case 3:return t.next=5,e.dispatch("history/pushHistory",{info:e.state.recordingInfo,blob:e.state.mergedBlob},{root:!0});case 5:case"end":return t.stop()}}),t)})))()},pushFrame:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.commit("pushBlob",t),e.dispatch("tempcache/pushItem",t,{root:!0});case 2:case"end":return r.stop()}}),r)})))()}}}},W=(r("d3b7"),r("ddb0"),r("13d5"),r("edfe")),G=Object(W["b"])("items","recording"),K=Object(W["b"])("infos","recording");function Q(){return Z.apply(this,arguments)}function Z(){return Z=Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["d"])(K);case 2:return e.next=4,e.sent.reduce((function(e,t){return e[t[0]]=t[1],e}),{});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return te=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["e"])(t,G);case 2:if(r=e.sent,!r){e.next=7;break}return e.abrupt("return",r);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)}))),te.apply(this,arguments)}function re(e,t){return ne.apply(this,arguments)}function ne(){return ne=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,Object(W["g"])(n,r,G);case 3:return e.next=5,Object(W["g"])(n,t,K);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)}))),ne.apply(this,arguments)}function ae(e){return oe.apply(this,arguments)}function oe(){return oe=Object(h["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["c"])(t,G);case 2:return e.next=4,Object(W["c"])(t,K);case 4:case"end":return e.stop()}}),e)}))),oe.apply(this,arguments)}function ie(){return ce.apply(this,arguments)}function ce(){return ce=Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["a"])(K);case 2:return e.next=4,Object(W["a"])(G);case 4:case"end":return e.stop()}}),e)}))),ce.apply(this,arguments)}var se=function(){return{state:{isInited:!1,historyInfos:null},getters:{historyIdxs:function(e){return B.a.keys(e.historyInfos)}},mutations:{addHistoryItem:function(e,t){0==e.isInited&&Object(U["error"])("错误，还没初始化"),e.historyInfos=Object(E["a"])(Object(E["a"])({},e.historyInfos),{},Object(H["a"])({},t.id,t)),alert(t)},initHistoryInfo:function(e,t){e.isInited=!0,e.historyInfos=B.a.cloneDeep(t)},removeItem:function(e,t){0==context.state.isInited&&Object(U["error"])("错误，还没初始化"),t in e.historyInfos&&delete e.historyInfos[t]},updateInfo:function(e,t){var r=t.id,n=t.newInfo;0==e.isInited&&Object(U["error"])("错误，还没初始化"),r!=n.id&&Object(U["error"])("不能更新Item的id，id不可更改"),r in e.historyInfos&&(e.historyInfos[r]=n)}},actions:{pushHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.info,a=t.blob,r.next=3,re(n,a);case 3:e.commit("addHistoryItem",n);case 4:case"end":return r.stop()}}),r)})))()},removeHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,ae(t);case 2:e.commit("removeItem",t);case 3:case"end":return r.stop()}}),r)})))()},renameHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=t.id,a=t.newName,0==e.state.isInited&&Object(U["error"])("错误，还没初始化"),o=e.state.historyInfos[n],o.name=a,e.commit("updateInfo",{id:n,newInfo:o});case 5:case"end":return r.stop()}}),r)})))()},clearHistory:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ie();case 2:e.commit("initHistoryInfo",{});case 3:case"end":return t.stop()}}),t)})))()},ensureInitHistory:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.state.isInited){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Q();case 4:r=t.sent,e.commit("initHistoryInfo",r);case 6:case"end":return t.stop()}}),t)})))()},getItem:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(t in e.state.historyInfos)){r.next=9;break}if(n=e.state.historyInfos[t],a=ee(t),null!=n&&null!=a){r.next=6;break}return console.error("获取记录时出现错误，存在空记录"),r.abrupt("return",null);case 6:return r.abrupt("return",{info:n,blob:a});case 9:return r.abrupt("return",null);case 10:case"end":return r.stop()}}),r)})))()}}}},ue=function(){return new N["a"]({modules:{recorder:Object(E["a"])({namespaced:!0},q()),history:Object(E["a"])({namespaced:!0},se())}})},le=r("8c4f"),de=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"hello"},[r("el-dialog",{attrs:{visible:e.showPlayer,fullscreen:""},on:{"update:visible":function(t){e.showPlayer=t}}},[r("div",{staticClass:"player"},[r("div",{staticClass:"player_info"},[r("h3",[e._v(" 当前录音:"+e._s(null==e.nowRecordInfo?"无":e.nowRecordInfo.name)+" ")]),null!=e.nowRecordInfo?r("div",[r("el-card",{attrs:{shadow:"never"}},[r("div",[e._v("名称:"+e._s(e.nowRecordInfo["name"]))]),r("div",[e._v("类型:"+e._s(e.nowRecordInfo["recordType"]))]),r("div",[e._v("ID:"+e._s(e.nowRecordInfo["id"]))]),r("div",[e._v("长度:"+e._s(e.secondToTime(e.nowRecordInfo["length"])))]),r("div",[e._v("开始时间:"+e._s(e.formatDate(e.nowRecordInfo["startTime"])))]),r("div",[e._v("结束时间:"+e._s(e.formatDate(e.nowRecordInfo["endTime"])))])])],1):e._e(),r("div",{staticStyle:{"margin-top":"2rem"}}),r("div",[r("video",{ref:"player",staticStyle:{outline:"none","max-width":"100%"},attrs:{src:e.src,controls:""}})]),r("div",{staticStyle:{"margin-top":"2rem"}}),r("div",[r("el-button",{staticStyle:{margin:"2rem"},attrs:{type:"success"},on:{click:e.download}},[e._v("下载")]),r("el-dropdown",{staticStyle:{margin:"2rem"}},[r("el-button",{attrs:{type:"success"},on:{click:e.downloadAll}},[e._v(" 下载全部（悬浮查看更多）"),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{on:{click:e.downloadAll_packed}},[e._v("打包下载全部（zip）")]),r("el-dropdown-item",{on:{click:e.downloadAll_packed_private}},[e._v("打包下载全部（专用格式）")])],1)],1),r("el-button",{staticStyle:{margin:"2rem"},attrs:{type:"primary"},on:{click:e.clear}},[e._v("清除历史记录")])],1)]),r("div",{staticClass:"player_list"},[r("el-table",{attrs:{"max-height":"600",border:"",data:e.playList}},[r("el-table-column",{attrs:{label:"名称",prop:"name",sortable:""}}),r("el-table-column",{attrs:{label:"开始时间",width:"160px",prop:"startTime",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(e._s(e.formatDate(t.row.startTime)))])]}}])}),r("el-table-column",{attrs:{width:"130px",label:"大小",prop:"size",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(e._s(e.filesize(t.row.size)))])]}}])}),r("el-table-column",{attrs:{width:"100px",label:"长度",prop:"length",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(e._s(e.secondToTime(t.row.length)))])]}}])}),r("el-table-column",{attrs:{label:"操作",align:"right","header-align":"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.select(t.row.id)}}},[e._v("查看")]),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return e.playlist_del(t.row.id)}}},[e._v("删除")]),r("el-button",{attrs:{type:"success",size:"small"},on:{click:function(r){return e.playlist_download(t.row.id)}}},[e._v("下载")]),r("el-button",{attrs:{type:"info",size:"small"},on:{click:function(r){return e.playlist_rename(t.row.id)}}},[e._v("重命名")])]}}])})],1)],1)])]),r("el-dialog",{staticClass:"notedialog",attrs:{title:"输入内容",visible:e.noteContentVisible,width:"70%",fullscreen:"md"==e.$mq},on:{"update:visible":function(t){e.noteContentVisible=t}}},[r("mavon-editor",{staticStyle:{width:"100%"},style:{height:"60vh"},model:{value:e.nowEditNote.content,callback:function(t){e.$set(e.nowEditNote,"content",t)},expression:"nowEditNote.content"}})],1),r("el-dialog",{attrs:{"show-close":!1,title:"输入笔记",visible:e.isNoteEditing,width:"70%",fullscreen:"md"==e.$mq,"before-close":e.onnote_cancel},on:{"update:visible":function(t){e.isNoteEditing=t}}},[r("el-form",[r("el-form-item",{attrs:{label:"标题"}},[r("el-input",{attrs:{autofocus:""},model:{value:e.nowEditNote.title,callback:function(t){e.$set(e.nowEditNote,"title",t)},expression:"nowEditNote.title"}})],1),r("el-form-item",{attrs:{label:"简要描述"}},[r("el-input",{model:{value:e.nowEditNote.desc,callback:function(t){e.$set(e.nowEditNote,"desc",t)},expression:"nowEditNote.desc"}})],1),r("el-form-item",{staticStyle:{display:"flex","flex-direction":"row-reverse"}},[r("span",{staticStyle:{"margin-right":"3rem","font-size":"16px","font-weight":"bold"}},[e._v("已输入:"+e._s(e.nowEditNote.content.length)+"字")]),r("el-button",{attrs:{type:"primary"},on:{click:e.note_inputcontent}},[e._v("输入内容")])],1)],1),r("el-row",{staticStyle:{"margin-top":"1.5rem",display:"flex","justify-content":"space-around"}},[r("el-button",{on:{click:e.note_cancel}},[e._v("取消")]),r("el-button",{attrs:{type:"success"},on:{click:e.note_confirm}},[e._v("确认")])],1)],1),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.stopping||e.loading,expression:"stopping || loading"}],staticClass:"recorder"},[r("div",[r("video",{directives:[{name:"show",rawName:"v-show",value:"video"==e.recordingInfo.recordType,expression:"recordingInfo.recordType == 'video'"}],ref:"record_video_player",staticStyle:{"max-width":"100%"}})]),r("el-row",{staticStyle:{"margin-top":"1.5rem",display:"flex","justify-content":"flex-end",height:"2.5rem","margin-right":"2.5rem"}},[r("select-source",{ref:"selectSource",staticStyle:{width:"300px"},attrs:{value:e.selectMediaValue},on:{"update:value":function(t){e.selectMediaValue=t},select:e.sourceSelect}}),null==e.recorder?r("el-button",{attrs:{type:"primary",size:"small"}},[e._v(" 设备初始化 ")]):e._e()],1),r("el-divider"),r("el-row",[r("h2",[e._v("当前录制:"+e._s(e.recordTime))]),null==e.recorder?r("el-row",[r("h3",[e._v("当前设备尚未初始化，请选择媒体完成初始化")])]):e._e(),null!=e.recorder?r("el-row",["normal"==e.nowState||"stopped"==e.nowState?r("el-button",{attrs:{type:"success"},on:{click:e.start}},[e._v("开始")]):e._e(),"paused"==e.nowState?r("el-button",{attrs:{type:"success"},on:{click:e.resume}},[e._v("继续")]):e._e(),"recording"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.pause}},[e._v("暂停")]):e._e(),"recording"==e.nowState||"paused"==e.nowState?r("el-button",{attrs:{type:"danger"},on:{click:e.stop}},[e._v("停止")]):e._e(),"stopped"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.play}},[e._v("播放")]):e._e(),"stopped"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.download}},[e._v("下载当前录音")]):e._e(),"stopped"==e.nowState?r("el-button",{attrs:{type:"danger"},on:{click:e.removeNow}},[e._v("删除")]):e._e(),r("el-button",{attrs:{type:"warning"},on:{click:e.show_player}},[e._v("显示播放器")]),r("el-divider"),"recording"==e.nowState?r("el-button",{staticStyle:{"margin-right":"2rem"},attrs:{type:"primary"},on:{click:e.addPoint}},[e._v("添加标记点(空格键添加)")]):e._e(),"recording"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.addNote}},[e._v("添加笔记")]):e._e(),"recording"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.addBrief}},[e._v(" 添加记录点 ")]):e._e(),r("div",[r("ul",e._l(e.recordingInfo.points,(function(t,n){return r("el-button",{key:t.time,attrs:{type:"text"},on:{click:function(t){return e.showRecordingPoint(n)}}},[e._v(" "+e._s(t.time)+" ")])})),1)])],1):e._e()],1)],1)],1)},pe=[],fe=r("b85c"),me=(r("3ca3"),r("d81d"),r("99af"),r("2b3d"),r("4de4"),r("cee5")),he=r.n(me),be=r("cff8"),ve=r.n(be),we=r("c4e3"),ge=r.n(we),ye=r("7f81"),xe=r.n(ye),Re=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("textarea",{on:{keydown:function(t){return e.down(t)},keyup:function(t){return e.up(t)}}})])},ke=[],Oe={data:function(){return{timelist:[]}},watch:{timelist:function(){console.log(this.timelist)}},methods:{down:function(e){this.timelist.push({code:e.code,type:"down"})},up:function(e){this.timelist.push({code:e.code,type:"up"})},get:function(){return this.timelist}}},je=Oe,_e=Object(l["a"])(je,Re,ke,!1,null,"a509bd70",null),Ie=_e.exports,Se="historyBlobs",Te="historyBlobsInfoMap",Ne="tempcache",Me=Object(W["b"])(Ne,Ne),Be="recordingInfo";var Ee,$e,De={components:{TimeLineNote:Ie,SelectSource:g},name:"HelloWorld",props:{msg:String},watch:{selectMediaValue:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:null!=e.recordingInfo&&(e.recordingInfo.source=e.selectMediaValue);case 1:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,e.loadHistoryIdx(),t.next=5,e.tempCacheEmpty();case 5:if(t.sent){t.next=13;break}return t.next=8,e.getTempRecordingInfo();case 8:r=t.sent,e.selectMediaValue=r.source,e.$nextTick(Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.startFormTempCache();case 2:case"end":return t.stop()}}),t)})))),t.next=15;break;case 13:return t.next=15,e.initRecorder();case 15:e.loading=!1,t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](0),e.loading=!1,e.$message.error("获取媒体设备错误");case 22:case"end":return t.stop()}}),t,null,[[0,18]])})))()},data:function(){return{selectMediaValue:"mic",videoStreamUrl:null,nowEditNote:{content:"",title:"",desc:""},noteContentVisible:!1,isNoteEditing:!1,loading:!1,player:null,recordingInfo:{recordType:"audio",source:"",points:[]},startTime:new Date,endTime:new Date,nowRecordInfo:null,blobs:[],mergedBlob:null,recorder:null,src:"",historyBlobsIdx:[],historyInfoMap:{},nowState:"normal",showPlayer:!1,stopping:!1}},computed:{recordTime:function(){return P()(0).second(this.blobs.length).subtract(8,"hours").format("HH:mm:ss")}},asyncComputed:{playList:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.historyBlobsIdx.map(function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.readHistoryItem(r);case 2:return n=t.sent,t.abrupt("return",{name:e.historyInfoMap[r].name,id:r,size:n.size,length:e.historyInfoMap[r].length,startTime:e.historyInfoMap[r].startTime});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()}},methods:{autoInit:function(){},sourceSelect:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs["selectSource"].getSelectedStream();case 2:r=t.sent,null==r&&Object(U["error"])("此媒體源不可用"),console.log(r),""!==e.selectMediaValue&&null!=r&&e.setSource(r);case 6:case"end":return t.stop()}}),t)})))()},setSource:function(e){if(null!=e){var t=e.type,r=e.stream;this.recordingInfo&&(this.recordingInfo.source=e.name),console.log(t),"audio"===t?(this.recordingInfo.recordType="audio",this.initRecorder(r)):"video"===t&&(this.recordingInfo.recordType="video",this.initVideoRecorder(r))}else Object(U["error"])("設置的媒體源無效")},initVideoRecorder:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.t0=e,r.t0){r.next=5;break}return r.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:!0});case 4:r.t0=r.sent;case 5:return n=r.t0,a=t.$refs["record_video_player"],a.srcObject=n,a.play(),o=15e5,r.next=12,t.$prompt("输入总码率（推荐1500000）:");case 12:i=r.sent,"confirm"==i.action&&(o=parseInt(i.value)),c=new MediaRecorder(n,{bitsPerSecond:o,audioBitrateMode:"variable",mimeType:"video/webm"}),c.ondataavailable=function(e){return t.dataavailable(e)},t.recorder=c;case 17:case"end":return r.stop()}}),r)})))()},initRecorder:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.t0=e,r.t0){r.next=5;break}return r.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 4:r.t0=r.sent;case 5:return n=r.t0,a=128e3,r.next=9,t.$prompt("输入音频码率（推荐128000）:");case 9:o=r.sent,"confirm"==o.action&&(a=parseInt(o.value)),i=new MediaRecorder(n,{bitsPerSecond:a,audioBitrateMode:"variable",mimeType:"audio/webm"}),i.ondataavailable=function(e){return t.dataavailable(e)},t.recorder=i;case 14:case"end":return r.stop()}}),r)})))()},note_inputcontent:function(){this.noteContentVisible=!0},filesize:function(e){return he()(e)},show_player:function(){this.showPlayer=!0},createPoint:function(e,t){var r=this.blobs.length,n=new Date;return{type:e,note:t,position:r,time:n}},formatDate:function(e){return P()(e).format("YYYY-MM-DD HH:mm:ss")},secondToTime:function(e){return P()(0).second(e).subtract(8,"hours").format("HH:mm:ss")},info_generate:function(e){var t=[],r=this.historyInfoMap[e];for(var n in r){var a="startTime"==n||"endTime"==n?this.formatDate(r[n]):"length"==n?this.secondToTime(r[n]):r[n];t.push("".concat(n,"：").concat(a))}return t},playlist_del:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.historyInfoMap[e],r.next=3,t.$confirm("是否要删除:"+n.name+"?");case 3:if(a=r.sent,"confirm"!=a){r.next=8;break}return e==t.nowRecordInfo.id&&t.clearNow(),r.next=8,t.removeItem(e);case 8:case"end":return r.stop()}}),r)})))()},playlist_download:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.historyInfoMap[e],t.$message.info("已开始下载："+n.name),r.t0=URL,r.next=5,t.readHistoryItem(e);case 5:return r.t1=r.sent,a=r.t0.createObjectURL.call(r.t0,r.t1),o=URL.createObjectURL(new Blob([JSON.stringify(n)])),r.next=10,t.downloadUrl(n.name+".webm",a);case 10:return URL.revokeObjectURL(a),r.next=13,t.downloadUrl(n.name+".json",o);case 13:URL.revokeObjectURL(n);case 14:case"end":return r.stop()}}),r)})))()},playlist_rename:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$prompt("请输入名称:","命名录音",{showCancelButton:!1,inputValue:t.historyInfoMap[e].name});case 2:if(n=r.sent,"confirm"!=n.action){r.next=8;break}return r.next=6,t.renameItem(e,n.value);case 6:r.next=10;break;case 8:return r.next=10,t.$alert("错误");case 10:case"end":return r.stop()}}),r)})))()},addPoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.createPoint("point",e);this.recordingInfo.points.push(t)},addNote:function(){this.isNoteEditing=!0},addBrief:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$prompt("输入记录描述(tips):","添加记录点");case 2:r=t.sent,"confirm"==r.action?(e.nowEditNote.title=r.value,e.nowEditNote.desc=r.value,e.nowEditNote.content=r.value,e.addPoint(e.nowEditNote)):e.clearNowEditNote();case 4:case"end":return t.stop()}}),t)})))()},clearNowEditNote:function(){this.nowEditNote={title:"",desc:"",content:""}},note_confirm:function(){this.addPoint(this.nowEditNote),this.isNoteEditing=!1,this.clearNowEditNote()},onnote_cancel:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("不保存笔记？");case 2:n=r.sent,"confirm"==n&&(t.clearNowEditNote(),e());case 4:case"end":return r.stop()}}),r)})))()},note_cancel:function(){var e=this;this.onnote_cancel((function(){e.isNoteEditing=!1}))},showRecordingPoint:function(e){var t=this.recordingInfo.points[e];this.$message(JSON.stringify(t))},play:function(){this.showPlayer=!0;var e=this.$refs.player;e.play()},play_pause:function(){var e=this.$refs.player;e.pause()},play_stop:function(){var e=this.$refs.player;e.fastSeek(0),this.play_pause()},select:function(e){var t=this;console.log(e),"recording"!=this.nowState&&"paused"!=this.nowState?(this.clearNow(),this.readHistoryItem(e).then((function(r){t.loadNow(e,r)}))):this.$message.error("不能在录音时进行播放，请先停止录音")},stateSwitch:function(e){this.nowState=e},dataavailable:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t.stopping){r.next=2;break}return r.abrupt("return");case 2:return n=t.stopping,t.stopping&&(t.stopping=!1),t.blobs.push(e.data),t.endTime=new Date,console.log(e),r.next=9,t.addRecordFrame(e.data);case 9:return r.next=11,t.storeRecording();case 11:if(!n){r.next=14;break}return r.next=14,t.stop_after();case 14:case"end":return r.stop()}}),r)})))()},start:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.clearNow(),e.startTime=new Date,e.endTime=new Date,e.recorder.start(1e3),t.next=6,e.storeRecording();case 6:e.stateSwitch("recording");case 7:case"end":return t.stop()}}),t)})))()},getTempRecordingInfo:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ve.a.get(Be);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))()},startFormTempCache:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.tempCacheEmpty();case 2:if(!t.sent){t.next=4;break}throw new Error("不存在上次记录");case 4:return t.next=6,e.loadTempCache();case 6:return e.blobs=t.sent,t.next=9,ve.a.get(Be);case 9:r=t.sent,e.startTime=r["startTime"],e.endTime=r["endTime"],e.recordingInfo.points=r["points"],console.log(e.recorder),e.loading=!0,e.$watch("recorder",(function(){e.recorder&&(e.recorder.start(1e3),e.stateSwitch("recording"),e.pause()),e.loading=!1}),{immediate:!0});case 16:case"end":return t.stop()}}),t)})))()},storeRecording:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ve.a.set(Be,Object(E["a"])({startTime:e.startTime,endTime:e.endTime},e.recordingInfo));case 2:case"end":return t.stop()}}),t)})))()},addRecordFrame:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.blobs.length-1,r.next=3,Object(W["g"])(n,e,Me);case 3:case"end":return r.stop()}}),r)})))()},resume:function(){var e=this.recorder;e.resume(),this.stateSwitch("recording")},pause:function(){var e=this.recorder;e.pause(),this.stateSwitch("paused")},clearTempCache:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["a"])(Me);case 2:case"end":return e.stop()}}),e)})))()},tempCacheEmpty:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["e"])(0,Me);case 2:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0==e.t1);case 5:case"end":return e.stop()}}),e)})))()},loadTempCache:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["d"])(Me);case 2:return t=e.sent,t=t.sort((function(e,t){e[0],t[0]})),r=t.map((function(e){return e[1]})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))()},stop:function(){var e=this;this.recorder.stop(),this.stopping=!0,this.stop_after().then((function(){e.stopping=!1}))},stop_after:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(U["delay"])(0);case 2:return e.stateSwitch("merging"),e.mergeBlobs(e.blobs),e.pushToHistory(),t.next=7,e.clearTempCache();case 7:return e.stateSwitch("stopped"),t.next=10,e.$prompt("请输入名称:","命名录音",{showCancelButton:!1,inputValue:e.nowRecordInfo.id});case 10:if(r=t.sent,"confirm"!=r.action){t.next=23;break}return n=e.nowRecordInfo.id,t.next=15,e.renameItem(e.nowRecordInfo.id,r.value);case 15:return t.t0=e,t.t1=n,t.next=19,e.readHistoryItem(n);case 19:t.t2=t.sent,t.t0.loadNow.call(t.t0,t.t1,t.t2),t.next=25;break;case 23:return t.next=25,e.$alert("错误");case 25:case"end":return t.stop()}}),t)})))()},download:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""==e.src){t.next=7;break}return e.$message.info("已开始下载："+e.nowRecordInfo.name),e.downloadUrl(e.nowRecordInfo.name+".webm",e.src),r=URL.createObjectURL(new Blob([JSON.stringify(e.nowRecordInfo)])),t.next=6,e.downloadUrl(e.nowRecordInfo.name+".json",r);case 6:URL.revokeObjectURL(r);case 7:case"end":return t.stop()}}),t)})))()},downloadAll:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.$message.warning({message:"正在顺序下载所有内容",duration:0,showClose:!0}),n=Object(fe["a"])(e.historyBlobsIdx),t.prev=2,n.s();case 4:if((a=n.n()).done){t.next=10;break}return o=a.value,t.next=8,e.playlist_download(o);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:r.close();case 19:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))()},downloadAll_packed:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,i,c,s,u,l,d,p,f,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("zip压缩下载有总大小限制，可能导致失败与卡顿，确定使用此方式下载吗（可选择专用格式）？");case 2:if(r=t.sent,"confirm"==r){t.next=5;break}return t.abrupt("return");case 5:n=e.$message.warning({message:"正在打包......",duration:0,showClose:!0}),a=new ge.a,o=e.historyBlobsIdx,i=Object(fe["a"])(o),t.prev=10,i.s();case 12:if((c=i.n()).done){t.next=24;break}return s=c.value,u=a.folder(s),l=e.historyInfoMap[s],t.next=18,e.readHistoryItem(s);case 18:d=t.sent,u.file("".concat(s,".json"),Object(U["json"])(l)),u.file("".concat(s,".webm"),d),n.message="加入记录:".concat(s);case 22:t.next=12;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t["catch"](10),i.e(t.t0);case 29:return t.prev=29,i.f(),t.finish(29);case 32:return n.message="记录加入完成，正在进行压缩......",p=e.$message.info({message:"进度:0",duration:0,showClose:!1}),t.next=36,a.generateAsync({type:"blob",compression:"STORE"},(function(e){p.message="进度:".concat(e.percent," \n 已压缩:").concat(e.currentFile)}));case 36:return f=t.sent,m=URL.createObjectURL(f),n.close(),e.$message.warning("已经开始下载打包文件"),t.next=42,e.downloadUrl("packageRecords.zip",m);case 42:URL.revokeObjectURL(m);case 43:case"end":return t.stop()}}),t,null,[[10,26,29,32]])})))()},downloadAll_packed_private:function(){this.$msgbox("尚未实现此功能，敬请期待")},removeNow:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.playlist_del(e.nowRecordInfo.id);case 2:case"end":return t.stop()}}),t)})))()},clear:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("确定要清除所有记录吗?",{type:"warning"});case 2:r=t.sent,"confirm"==r&&e.clearHistroy();case 4:case"end":return t.stop()}}),t)})))()},downloadUrl:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=new xe.a({url:t,filename:e}),r.next=3,n;case 3:case"end":return r.stop()}}),r)})))()},mergeBlobs:function(e){var t=new Blob(e,{type:"audio/webm"});this.src=URL.createObjectURL(t),this.mergedBlob=t;var r="record_".concat(P()(this.startTime).format("YYYY-MM-DD hh:mm:ss"),"_").concat(P()(this.endTime).format("YYYY-MM-DD hh:mm:ss"));this.nowRecordInfo=Object(E["a"])({name:r,id:r,startTime:this.startTime,endTime:this.endTime,timeSpanList:[],length:e.length},this.recordingInfo)},clearNow:function(){null!=this.src&&""!=this.src&&(URL.revokeObjectURL(this.src),this.src="",this.mergedBlob=null,this.blobs=[],this.nowRecordInfo=null)},loadNow:function(e,t){this.clearNow(),this.mergedBlob=t,this.blobs=[],this.nowRecordInfo=this.historyInfoMap[e],this.src=URL.createObjectURL(t)},pushToHistory:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(-1==e.historyBlobsIdx.indexOf(e.nowRecordInfo.id)){t.next=2;break}throw new Error("已经存在同名历史记录");case 2:if(null!=e.mergedBlob&&null!=e.nowRecordInfo.id){t.next=4;break}throw new Error("错误调用");case 4:return t.next=6,e.addItem(e.nowRecordInfo,e.mergedBlob);case 6:case"end":return t.stop()}}),t)})))()},addItem:function(e,t){var r=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r.historyBlobsIdx.push(e.id),ve()(Se,r.historyBlobsIdx),r.historyInfoMap[e.id]=e,ve()(Te,r.historyInfoMap),n.next=6,Object(W["g"])(Se+e.id,t);case 6:case"end":return n.stop()}}),n)})))()},loadHistoryIdx:function(){ve.a.has(Se)?this.historyBlobsIdx=ve.a.get(Se):this.historyBlobsIdx=[],ve.a.has(Te)?this.historyInfoMap=ve.a.get(Te):this.historyInfoMap={}},clearHistroy:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=Object(fe["a"])(e.historyBlobsIdx),t.prev=1,r.s();case 3:if((n=r.n()).done){t.next=9;break}return a=n.value,t.next=7,Object(W["c"])(Se+a);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),r.e(t.t0);case 14:return t.prev=14,r.f(),t.finish(14);case 17:ve.a.remove(Se),ve.a.remove(Te),e.clearNow(),e.loadHistoryIdx();case 21:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})))()},readHistoryItem:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(-1!=t.historyBlobsIdx.indexOf(e)){r.next=2;break}throw new Error("记录"+e+"不存在");case 2:return r.next=4,Object(W["e"])(Se+e);case 4:return n=r.sent,r.abrupt("return",n);case 6:case"end":return r.stop()}}),r)})))()},removeItem:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(-1!=t.historyBlobsIdx.indexOf(e)){r.next=2;break}throw new Error("没有这个记录");case 2:return t.historyBlobsIdx=t.historyBlobsIdx.filter((function(t){return t!=e})),delete t.historyInfoMap[e],ve.a.set(Te,t.historyInfoMap),ve.a.set(Se,t.historyBlobsIdx),r.next=8,Object(W["c"])(Se+e);case 8:case"end":return r.stop()}}),r)})))()},renameItem:function(e,t){var r=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(-1!=r.historyBlobsIdx.indexOf(e)){n.next=2;break}throw new Error("没有这个记录");case 2:return n.next=4,r.readHistoryItem(e);case 4:return a=n.sent,o=r.historyInfoMap[e],n.next=8,r.removeItem(e);case 8:return o.name=t,n.next=11,r.addItem(o,a);case 11:case"end":return n.stop()}}),n)})))()}}},He=De,Ce=(r("a8b4"),Object(l["a"])(He,de,pe,!1,null,"d6eeed06",null)),Ue=Ce.exports,Le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("ul",e._l(e.historyInfos,(function(t,n){return r("li",{key:n},[e._v(e._s(JSON.stringify(t)))])})),0),e._v(" "+e._s(e.recordingLength)+" "),r("el-button",{on:{click:e.startNew}},[e._v("开始")]),r("el-button",{on:{click:e.resume}},[e._v("继续")]),r("el-button",{on:{click:e.pause}},[e._v("暂停")]),r("el-button",{on:{click:function(t){return e.saveRecording()}}},[e._v("开始")])],1)},Pe=[],Ye={data:function(){return{}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ensureInitHistory();case 2:case"end":return t.stop()}}),t)})))()},computed:Object(E["a"])(Object(E["a"])(Object(E["a"])({},Object(N["d"])("recorder",["recordingLength"])),Object(N["d"])("history",["historyIdxs"])),Object(N["e"])("history",["historyInfos"])),methods:Object(E["a"])(Object(E["a"])({},Object(N["c"])("recorder",["startNew","pause","saveRecording","resume"])),Object(N["c"])("history",["ensureInitHistory"]))},Ae=Ye,ze=Object(l["a"])(Ae,Le,Pe,!1,null,"402d414c",null),Ve=ze.exports,Fe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v(" "+e._s(e.countA)+" "+e._s(e.hello)+" "),r("el-button",{attrs:{type:"primary"},on:{click:e.test}},[e._v("+1")]),r("div",[e._v(" "+e._s(e.countAdd)+" ")])],1)},Xe=[],Je=r("257e"),qe=r("262e"),We=r("2caf"),Ge=r("2fe1"),Ke=(Ee=Object(Ge["a"])({computed:Object(E["a"])(Object(E["a"])({},Object(N["e"])(["countA"])),{},{hello:function(){return this.countAdd+this.$store.state.countA}})}),Ee($e=function(e){Object(qe["a"])(r,e);var t=Object(We["a"])(r);function r(){var e;Object($["a"])(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),Object(H["a"])(Object(Je["a"])(e),"count",0),e}return Object(D["a"])(r,[{key:"countAdd",get:function(){return this.count+1}},{key:"test",value:function(){this.count++,this.$store.commit("increment")}},{key:"mounted",value:function(){alert("hello")}}]),r}(n["default"]))||$e),Qe=Ke,Ze=Qe,et=Object(l["a"])(Ze,Fe,Xe,!1,null,"b151066e",null),tt=et.exports,rt=r("b2d8"),nt=r.n(rt),at=(r("64e1"),r("660e"));n["default"].config.productionTip=!1,n["default"].use(O),n["default"].use(j["a"]),n["default"].use(S["a"]),n["default"].use(N["b"]);var ot=ue();n["default"].use(le["a"]);var it=[{path:"/",component:Ue},{path:"/center",component:tt},{path:"/new",component:Ve}],ct=new le["a"]({routes:it});n["default"].use(I.a,{name:"ls",bind:!0}),n["default"].use(nt.a),n["default"].use(at["a"],{breakpoints:{sm:450,md:950,lg:1/0},defaultBreakpoint:"sm"});var st=document.createElement("div");document.body.append(st),new n["default"]({render:function(e){return e(k)},store:ot,router:ct,el:st})},"62bf":function(e,t,r){},"8ae7":function(e,t,r){},"9a51":function(e,t,r){},a8b4:function(e,t,r){"use strict";r("62bf")},b044:function(e,t,r){"use strict";r("8ae7")}});
//# sourceMappingURL=app.4838f709.js.map