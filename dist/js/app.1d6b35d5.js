(function(e){function t(t){for(var r,i,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/offline-recorder/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"05c1":function(e,t,n){},"29d8":function(e,t,n){"use strict";n("9a51")},"8ae7":function(e,t,n){},"9a51":function(e,t,n){},b044:function(e,t,n){"use strict";n("8ae7")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",[n("router-view")],1)])},a=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"cont",staticClass:"container",staticStyle:{background:"green"},style:{left:e.x+"px",top:e.y+"px"},on:{mouseover:function(t){return e.enter(t)},mouseout:function(t){return e.leave(t)},mousedown:function(t){return e.down(t)}}},[e._t("default")],2)},s=[],c={data:function(){return{x:0,y:0,beforeDrag:!1,draging:!1,dragX:0,dragY:0}},mounted:function(){var e=this;document.addEventListener("mousemove",(function(t){return e.move(t)})),document.addEventListener("mouseup",(function(t){return e.up(t)}))},methods:{isdrag:function(e){var t=e.target.dataset["draggable"];return!!t},enter:function(e){this.draging||this.isdrag(e)&&(this.beforeDrag=!0,this.draging=!1)},leave:function(e){this.draging||this.isdrag(e)&&(this.beforeDrag=!1,this.draging=!1)},move:function(e){this.draging&&(this.x=e.clientX-this.dragX,this.y=e.clientY-this.dragY,console.log(this.dragX,this.dragY))},down:function(e){if(e.currentTarget==this.$refs["cont"]){var t=e.currentTarget.getBoundingClientRect();this.dragX=e.clientX-t.left,this.dragY=e.clientY-t.top,console.log(this.dragX,this.dragY)}this.isdrag(e)&&this.beforeDrag&&(this.beforeDrag=!1,this.draging=!0)},up:function(e){this.draging&&(this.beforeDrag=!0,this.draging=!1),this.effect()},effect:function(){this.x<0&&(this.x=0),Math.abs(this.x)<20&&(this.x=0),Math.abs(this.y)<20&&(this.x=0)}}},u=c,l=(n("29d8"),n("2877")),d=Object(l["a"])(u,i,s,!1,null,"487e012f",null),p=d.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["sm"!=e.$mq?n("el-form",[n("el-form-item",{attrs:{label:"媒体源"}},[n("el-select",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.medianames,(function(e){return n("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1):e._e(),"sm"==e.$mq?n("div",[n("van-picker",{attrs:{title:"选择媒体源","show-toolbar":"",columns:e.selectList},on:{confirm:e.select}})],1):e._e()],1)},m=[],h=n("c964"),v=(n("96cf"),n("d81d"),n("b0c0"),n("3ad6")),b=n("2ef0"),w=n.n(b);function g(e){return y.apply(this,arguments)}function y(){return y=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={mic:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getUserMedia({audio:!0,video:!1}));case 1:case"end":return e.stop()}}),e)})))()},capture:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getUserMedia({audio:!0,video:!0}));case 1:case"end":return e.stop()}}),e)})))()},screen:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}));case 1:case"end":return e.stop()}}),e)})))()},audiooutput:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0});case 2:return t=e.sent,n=t.getAudioTracks(),console.log(n),e.abrupt("return",new MediaStream(n));case 6:case"end":return e.stop()}}),e)})))()}},t in n!==!1){e.next=3;break}return e.abrupt("return",null);case 3:return e.prev=3,e.next=6,n[t]();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e["catch"](3),Object(v["error"])("此媒体源不可用，请切换媒体源");case 12:case"end":return e.stop()}}),e,null,[[3,9]])}))),y.apply(this,arguments)}var x={mic:"audio",capture:"video",screen:"video",audiooutput:"audio"};function _(e){return R.apply(this,arguments)}function R(){return R=Object(h["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:return e.t0=e.sent,e.t1=t,e.t2=x[t],e.abrupt("return",{stream:e.t0,name:e.t1,type:e.t2});case 6:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}var k={props:{value:{type:String,default:""}},data:function(){return{selected:"",medianames:[{name:"麦克风（音频）",value:"mic"},{name:"摄像头（视频+音频）",value:"capture"},{name:"录屏(视频+电脑内音频）",value:"screen"},{name:"内部音源(电脑内音频）",value:"audiooutput"}]}},computed:{selectList:function(){return this.medianames.map((function(e){return e.name}))}},methods:{select:function(e,t){var n=this.medianames[t];this.selected=n.value}},watch:{value:function(){this.selected=this.value},selected:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$emit("update:value",e.selected),e.$emit("select");case 2:case"end":return t.stop()}}),t)})))()}}},O=k,j=Object(l["a"])(O,f,m,!1,null,null,null),I=j.exports,S={components:{GWidget:p,SelectSource:I},name:"App",data:function(){return{active:"2"}}},N=S,T=(n("b044"),Object(l["a"])(N,o,a,!1,null,null,null)),M=T.exports,$=n("5c96"),E=(n("0fae"),n("b970")),B=(n("157a"),n("4380")),D=n("ead5"),C=n.n(D),H=n("3003"),L=n("9483");Object(L["a"])("".concat("/offline-recorder/dist/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var U=n("2f62"),A=n("f3f3"),P=n("276c"),Y=n("e954"),z=n("ec26"),V=n("5a0c"),q=n.n(V),F=n("2bd2");function J(){return{id:"record_".concat(Object(z["a"])()),name:"record_".concat(q()().format("YYYY-MM-DD HH:mm:ss")),startTime:new Date,endTime:new Date,points:[]}}function X(e){var t=G();return t.type="pause",t.data={pause_type:e,time:new Date},t}function G(){return{type:"point",data:null}}var W=function(){function e(){Object(P["a"])(this,e),this.recorder=null,this.onDataAvailable=new F["a"]}return Object(Y["a"])(e,[{key:"ensureinit",value:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==this.recorder){e.next=2;break}return e.abrupt("return");case 2:return t=navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),e.t0=MediaRecorder,e.next=6,t;case 6:e.t1=e.sent,e.t2={bitsPerSecond:128e3,audioBitrateMode:"variable",mimeType:"audio/webm"},n=new e.t0(e.t1,e.t2),this.recorder=n,n.addEventListener("dataavailable",(function(e){return r.onDataAvailable.next(e.data)}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),K=new W,Q=null,Z=function(){return{state:{mergedBlob:null,blobs:[],state:"normal",recordingInfo:null},mutations:{mergeBlob:function(e){e.mergedBlob=new Blob(e.blobs),e.blobs=[]},pushBlob:function(e,t){console.log("receive"),"recording"==e.state?e.blobs.push(t):console.error("状态错误，丢弃1帧")},addCheckPoint:function(e,t){if(null==e.recordingInfo)throw new Error("录制信息不存在，可能还没开始录音");e.recordingInfo.points.push(t)},setRecordingName:function(e,t){e.recordingInfo.name=t},switchState:function(e,t){switch(e.state){case"normal":"start"==t?(e.state="recording",e.recordingInfo=J()):Object(v["error"])("state和action不匹配");break;case"recording":if("pause"==t){e.state="paused";var n=X("pause");e.recordingInfo.points.push(n)}else"stop"==t?e.state="stopped":Object(v["error"])("state和action不匹配");break;case"paused":"stop"==t?e.state="stopped":"start"==t?(e.state="recording",e.recordingInfo.points.push(X("pause_resume"))):Object(v["error"])("state和action不匹配");break;case"stopped":"recover"==t?(e.state="normal",e.blobs=[],e.recordingInfo=null,e.mergedBlob=null):Object(v["error"])("state和action不匹配");break}}},getters:{recordingLength:function(e){return null==e.recordingInfo?null:e.blobs.length},historyBlobs:function(e){}},actions:{newRecorder:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},startNew:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,K.ensureinit();case 2:"normal"==e.state.state?(e.commit("switchState","start"),Q=K.onDataAvailable.subscribe((function(t){e.commit("pushBlob",t)})),K.recorder.start(1e3)):Object(v["error"])("还没恢复到未开始状态");case 3:case"end":return t.stop()}}),t)})))()},resume:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,K.ensureinit();case 2:if("paused"==e.state.state){t.next=5;break}return Object(v["error"])("并非在暂停状态，调用resume"),t.abrupt("return");case 5:e.commit("switchState","start"),K.recorder.resume();case 7:case"end":return t.stop()}}),t)})))()},pause:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit("switchState","pause"),t.next=3,K.ensureinit();case 3:K.recorder.pause();case 4:case"end":return t.stop()}}),t)})))()},saveRecording:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.commit("switchState","stop"),n.next=3,K.ensureinit();case 3:return K.recorder.stop(),Q.unsubscribe(),Q=null,null!=t&&e.commit("setRecordingName",t),n.next=9,e.dispatch("storeToDisk");case 9:e.dispatch("tempcache/clearCache",null,{root:!0}),e.commit("switchState","recover");case 11:case"end":return n.stop()}}),n)})))()},storeToDisk:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return null==e.state.mergedBlob&&e.commit("mergeBlob"),t.next=3,e.dispatch("history/ensureInitHistory",null,{root:!0});case 3:return t.next=5,e.dispatch("history/pushHistory",{info:e.state.recordingInfo,blob:e.state.mergedBlob},{root:!0});case 5:case"end":return t.stop()}}),t)})))()},pushFrame:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.commit("pushBlob",t),e.dispatch("tempcache/pushItem",t,{root:!0});case 2:case"end":return n.stop()}}),n)})))()}}}},ee=n("fc11"),te=(n("d3b7"),n("ddb0"),n("13d5"),n("edfe")),ne=Object(te["b"])("items","recording"),re=Object(te["b"])("infos","recording");function oe(){return ae.apply(this,arguments)}function ae(){return ae=Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(te["d"])(re);case 2:return e.next=4,e.sent.reduce((function(e,t){return e[t[0]]=t[1],e}),{});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}function ie(e){return se.apply(this,arguments)}function se(){return se=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(te["e"])(t,ne);case 2:if(n=e.sent,!n){e.next=7;break}return e.abrupt("return",n);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}function ce(e,t){return ue.apply(this,arguments)}function ue(){return ue=Object(h["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,Object(te["g"])(r,n,ne);case 3:return e.next=5,Object(te["g"])(r,t,re);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)}))),ue.apply(this,arguments)}function le(e){return de.apply(this,arguments)}function de(){return de=Object(h["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(te["c"])(t,ne);case 2:return e.next=4,Object(te["c"])(t,re);case 4:case"end":return e.stop()}}),e)}))),de.apply(this,arguments)}function pe(){return fe.apply(this,arguments)}function fe(){return fe=Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(te["a"])(re);case 2:return e.next=4,Object(te["a"])(ne);case 4:case"end":return e.stop()}}),e)}))),fe.apply(this,arguments)}var me=function(){return{state:{isInited:!1,historyInfos:null},getters:{historyIdxs:function(e){return w.a.keys(e.historyInfos)}},mutations:{addHistoryItem:function(e,t){0==e.isInited&&Object(v["error"])("错误，还没初始化"),e.historyInfos=Object(A["a"])(Object(A["a"])({},e.historyInfos),{},Object(ee["a"])({},t.id,t)),alert(t)},initHistoryInfo:function(e,t){e.isInited=!0,e.historyInfos=w.a.cloneDeep(t)},removeItem:function(e,t){0==context.state.isInited&&Object(v["error"])("错误，还没初始化"),t in e.historyInfos&&delete e.historyInfos[t]},updateInfo:function(e,t){var n=t.id,r=t.newInfo;0==e.isInited&&Object(v["error"])("错误，还没初始化"),n!=r.id&&Object(v["error"])("不能更新Item的id，id不可更改"),n in e.historyInfos&&(e.historyInfos[n]=r)}},actions:{pushHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.info,o=t.blob,n.next=3,ce(r,o);case 3:e.commit("addHistoryItem",r);case 4:case"end":return n.stop()}}),n)})))()},removeHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,le(t);case 2:e.commit("removeItem",t);case 3:case"end":return n.stop()}}),n)})))()},renameHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.id,o=t.newName,0==e.state.isInited&&Object(v["error"])("错误，还没初始化"),a=e.state.historyInfos[r],a.name=o,e.commit("updateInfo",{id:r,newInfo:a});case 5:case"end":return n.stop()}}),n)})))()},clearHistory:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pe();case 2:e.commit("initHistoryInfo",{});case 3:case"end":return t.stop()}}),t)})))()},ensureInitHistory:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.state.isInited){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,oe();case 4:n=t.sent,e.commit("initHistoryInfo",n);case 6:case"end":return t.stop()}}),t)})))()},getItem:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(t in e.state.historyInfos)){n.next=9;break}if(r=e.state.historyInfos[t],o=ie(t),null!=r&&null!=o){n.next=6;break}return console.error("获取记录时出现错误，存在空记录"),n.abrupt("return",null);case 6:return n.abrupt("return",{info:r,blob:o});case 9:return n.abrupt("return",null);case 10:case"end":return n.stop()}}),n)})))()}}}},he=function(){return new U["a"]({modules:{recorder:Object(A["a"])({namespaced:!0},Z()),history:Object(A["a"])({namespaced:!0},me())}})},ve=n("8c4f"),be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},["md"==e.$mq||"lg"==e.$mq?n("div",{staticClass:"pcui"},[n("el-dialog",{attrs:{fullscreen:"",title:"查看记录",visible:e.isShowingNote},on:{"update:visible":function(t){e.isShowingNote=t},keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.isShowingNote=!1}}},[n("show-note",{attrs:{data:e.nowShowedNote}}),n("el-divider"),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isShowingNote=!1}}},[e._v("关闭")])],1),n("h1",[e._v("离线录制")]),n("h4",[e._v("一款直接在浏览器中运行的录音机，数据离线实时保存（尚未适配手机）")]),n("div",{staticClass:"inner-card"},[n("el-collapse",{attrs:{accordion:""},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("el-collapse-item",{attrs:{name:"1"}},[n("template",{slot:"title"},[n("div",{staticStyle:{"padding-left":"2rem"}},[e._v("功能")])]),n("h3",[e._v(" 断电，关闭浏览器或录音时间过长超出内存等问题，都不丢失数据，重新打开继续录 ")]),n("h3",[e._v("数据保存在浏览器中，存储在本地电脑上，保护隐私")]),n("h3",[e._v("支持同时录多份录音文件，不会出现不下载就消失的情况")]),n("h3",[e._v("在线播放器，可在线预览，选择下载")]),n("h3",[e._v("自动记录额外信息，如录音时间段，长度大小等")]),n("h3",[e._v(' 可添加为WebApp（打开Chrome浏览器点击地址栏右侧“安装recorder"，手机可打开手机版Chrome后，根据底部提示操作） ')])],2),n("el-collapse-item",{attrs:{name:"2"}},[n("template",{slot:"title"},[n("div",{staticStyle:{"padding-left":"2rem"}},[e._v("注意事项")])]),n("h3",[e._v(" 切记本录音机不能在同一浏览器上同时打开两个，否则会造成存储混乱，对数据产生不可预测破坏 ")]),n("h3",[e._v("请勿清除浏览器记录，录音文件及时下载防止丢失")]),n("h3",[e._v(" 录音占用空间过大或一次录音时间过长时可能发生存储加载延迟，出现播放列表短暂不显示，等待一段时间即可 ")]),n("h3",[e._v(" 请不要在一个录音中使用多个源（目前版本），例如如果录屏，就一直使用录屏的视频源，中断后继续时也一样，不要切换到摄像头 ")])],2)],1)],1),n("div",{staticStyle:{"margin-top":"2rem"}}),n("div",[n("el-dialog",{attrs:{visible:e.showPlayer,fullscreen:""},on:{"update:visible":function(t){e.showPlayer=t}}},[n("div",{staticClass:"player"},[n("div",{staticClass:"player_info"},[n("h3",[e._v(" 当前录音:"+e._s(null==e.nowRecordInfo?"无":e.nowRecordInfo.name)+" ")]),null!=e.nowRecordInfo?n("div",[n("el-card",{attrs:{shadow:"never"}},[n("div",[e._v("名称:"+e._s(e.nowRecordInfo["name"]))]),n("div",[e._v("类型:"+e._s(e.nowRecordInfo["recordType"]))]),n("div",[e._v("ID:"+e._s(e.nowRecordInfo["id"]))]),n("div",[e._v("长度:"+e._s(e.secondToTime(e.nowRecordInfo["length"])))]),n("div",[e._v(" 开始时间:"+e._s(e.formatDate(e.nowRecordInfo["startTime"]))+" ")]),n("div",[e._v("结束时间:"+e._s(e.formatDate(e.nowRecordInfo["endTime"])))])])],1):e._e(),n("div",{staticStyle:{"margin-top":"2rem"}}),n("div",[n("video",{ref:"player",staticStyle:{outline:"none","max-width":"100%"},attrs:{src:e.src,controls:""}})]),n("div",{staticStyle:{"margin-top":"2rem"}}),n("div",[n("el-button",{staticStyle:{margin:"2rem"},attrs:{type:"success"},on:{click:e.download}},[e._v("下载")]),n("el-dropdown",{staticStyle:{margin:"2rem"}},[n("el-button",{attrs:{type:"success"},on:{click:e.downloadAll}},[e._v(" 下载全部（悬浮查看更多）"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{on:{click:e.downloadAll_packed}},[e._v("打包下载全部（zip）")]),n("el-dropdown-item",{on:{click:e.downloadAll_packed_private}},[e._v("打包下载全部（专用格式）")])],1)],1),n("el-button",{staticStyle:{margin:"2rem"},attrs:{type:"primary"},on:{click:e.clear}},[e._v("清除历史记录")])],1)]),n("div",{staticClass:"player_list"},[n("el-table",{attrs:{"max-height":"600",border:"",data:e.playList}},[n("el-table-column",{attrs:{label:"名称",prop:"name",sortable:""}}),n("el-table-column",{attrs:{label:"开始时间",width:"160px",prop:"startTime",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(e._s(e.formatDate(t.row.startTime)))])]}}],null,!1,2415485106)}),n("el-table-column",{attrs:{width:"130px",label:"大小",prop:"size",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(e._s(e.filesize(t.row.size)))])]}}],null,!1,2937803542)}),n("el-table-column",{attrs:{width:"100px",label:"长度",prop:"length",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(e._s(e.secondToTime(t.row.length)))])]}}],null,!1,4061846994)}),n("el-table-column",{attrs:{label:"操作",align:"right","header-align":"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.select(t.row.id)}}},[e._v("查看")]),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){return e.playlist_del(t.row.id)}}},[e._v("删除")]),n("el-button",{attrs:{type:"success",size:"small"},on:{click:function(n){return e.playlist_download(t.row.id)}}},[e._v("下载")]),n("el-button",{attrs:{type:"info",size:"small"},on:{click:function(n){return e.playlist_rename(t.row.id)}}},[e._v("重命名")])]}}],null,!1,158870327)})],1)],1)])]),n("el-dialog",{staticClass:"notedialog",attrs:{title:"输入内容",visible:e.noteContentVisible,width:"70%",fullscreen:"md"==e.$mq},on:{"update:visible":function(t){e.noteContentVisible=t}}},[n("mavon-editor",{staticStyle:{width:"100%"},style:{height:"60vh"},model:{value:e.nowEditNote.content,callback:function(t){e.$set(e.nowEditNote,"content",t)},expression:"nowEditNote.content"}})],1),n("el-dialog",{attrs:{"show-close":!1,title:"输入笔记",visible:e.isNoteEditing,width:"70%",fullscreen:"md"==e.$mq,"before-close":e.onnote_cancel},on:{"update:visible":function(t){e.isNoteEditing=t}}},[n("el-form",[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{attrs:{autofocus:""},model:{value:e.nowEditNote.title,callback:function(t){e.$set(e.nowEditNote,"title",t)},expression:"nowEditNote.title"}})],1),n("el-form-item",{attrs:{label:"简要描述"}},[n("el-input",{model:{value:e.nowEditNote.desc,callback:function(t){e.$set(e.nowEditNote,"desc",t)},expression:"nowEditNote.desc"}})],1),n("el-form-item",{staticStyle:{display:"flex","flex-direction":"row-reverse"}},[n("span",{staticStyle:{"margin-right":"3rem","font-size":"16px","font-weight":"bold"}},[e._v("已输入:"+e._s(e.nowEditNote.content.length)+"字")]),n("el-button",{attrs:{type:"primary"},on:{click:e.note_inputcontent}},[e._v("输入内容")])],1)],1),n("el-row",{staticStyle:{"margin-top":"1.5rem",display:"flex","justify-content":"space-around"}},[n("el-button",{on:{click:e.note_cancel}},[e._v("取消")]),n("el-button",{attrs:{type:"success"},on:{click:e.note_confirm}},[e._v("确认")])],1)],1),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.stopping||e.loading,expression:"stopping || loading"}],staticClass:"recorder"},[n("div",[n("video",{directives:[{name:"show",rawName:"v-show",value:"video"==e.recordingInfo.recordType,expression:"recordingInfo.recordType == 'video'"}],ref:"record_video_player",staticStyle:{"max-width":"100%"}})]),n("el-row",{staticStyle:{"margin-top":"1.5rem",display:"flex","justify-content":"flex-end",height:"2.5rem","margin-right":"2.5rem"}},[n("select-source",{staticStyle:{width:"300px"},attrs:{value:e.selectMediaValue},on:{"update:value":function(t){e.selectMediaValue=t},select:e.sourceSelect}})],1),n("el-divider"),n("el-row",[n("h2",[e._v("当前录制:"+e._s(e.recordTime))]),null==e.recorder?n("el-row",[n("h3",[e._v("当前设备尚未初始化，请选择媒体完成初始化")])]):e._e(),null!=e.recorder?n("el-row",["normal"==e.nowState||"stopped"==e.nowState?n("el-button",{attrs:{type:"success"},on:{click:e.start}},[e._v("开始")]):e._e(),"paused"==e.nowState?n("el-button",{attrs:{type:"success"},on:{click:e.resume}},[e._v("继续")]):e._e(),"recording"==e.nowState?n("el-button",{attrs:{type:"primary"},on:{click:e.pause}},[e._v("暂停")]):e._e(),"recording"==e.nowState||"paused"==e.nowState?n("el-button",{attrs:{type:"danger"},on:{click:e.stop}},[e._v("停止")]):e._e(),"stopped"==e.nowState?n("el-button",{attrs:{type:"primary"},on:{click:e.play}},[e._v("播放")]):e._e(),"stopped"==e.nowState?n("el-button",{attrs:{type:"primary"},on:{click:e.download}},[e._v("下载当前录音")]):e._e(),"stopped"==e.nowState?n("el-button",{attrs:{type:"danger"},on:{click:e.removeNow}},[e._v("删除")]):e._e(),n("el-button",{attrs:{type:"warning"},on:{click:e.show_player}},[e._v("显示播放器")]),n("el-divider"),"recording"==e.nowState?n("el-button",{staticStyle:{"margin-right":"2rem"},attrs:{type:"primary"},on:{click:e.addPoint}},[e._v("添加标记点(空格键添加)")]):e._e(),"recording"==e.nowState?n("el-button",{attrs:{type:"primary"},on:{click:e.addNote}},[e._v("添加笔记")]):e._e(),"recording"==e.nowState?n("el-button",{attrs:{type:"primary"},on:{click:e.addBrief}},[e._v(" 添加记录点 ")]):e._e(),n("el-row",{staticStyle:{padding:"2rem"}},e._l(e.recordingInfo.points,(function(t,r){return n("el-col",{key:t.time,attrs:{span:8}},[n("el-button",{staticStyle:{"margin-bottom":"1rem","margin-left":"2rem"},on:{click:function(t){return e.showRecordingPoint(r)}}},[e._v(" "+e._s("title"in t.note?"笔记:"+t.note.title:"标记点:"+e.formatDate(t.time))+" ")])],1)})),1)],1):e._e()],1)],1)],1)],1):e._e(),"sm"==e.$mq?n("div",{staticClass:"phoneui"},[n("van-row",[n("van-col",{attrs:{span:"12",offset:"6"}},[n("div",{staticStyle:{"font-size":"3rem"}},[e._v(e._s(e.recordTime))])])],1),null==e.recorder?n("van-row",[n("van-button",{on:{click:function(t){e.mobile_show_selectsource=!0}}},[e._v("当前设备尚未初始化，请选择媒体完成初始化")]),n("van-popup",{style:{height:"30%"},attrs:{closeable:"","close-icon-position":"top-left",position:"bottom"},model:{value:e.mobile_show_selectsource,callback:function(t){e.mobile_show_selectsource=t},expression:"mobile_show_selectsource"}},[n("select-source",{staticStyle:{width:"100%"},attrs:{value:e.selectMediaValue},on:{"update:value":function(t){e.selectMediaValue=t},select:e.sourceSelect}})],1)],1):e._e(),n("van-row",[n("van-col",{attrs:{span:"6"}},["recording"==e.nowState?n("van-icon",{attrs:{size:"10vw",name:"flag-o"},on:{click:e.addPoint}}):e._e()],1),n("van-col",{attrs:{span:"12"}},["normal"==e.nowState||"stopped"==e.nowState?n("van-icon",{attrs:{name:"play-circle-o",size:"10vw"},on:{click:e.start}}):e._e(),"recording"==e.nowState?n("van-icon",{attrs:{name:"pause-circle-o",size:"10vw"},on:{click:e.pause}}):e._e(),"paused"==e.nowState?n("van-icon",{attrs:{name:"play-circle-o",size:"10vw"},on:{click:e.resume}}):e._e()],1),n("van-col",{attrs:{span:"6"}},["recording"==e.nowState||"paused"==e.nowState?n("van-icon",{attrs:{name:"stop-circle-o",size:"10vw"},on:{click:e.stop}}):e._e()],1)],1),n("van-cell-group",[e._v(" 这里和pc不一样 这里可以点击并弹出笔记编辑页面 "),e._l(e.recordingInfo.points,(function(t,r){return n("van-cell",{key:t.time,attrs:{"is-link":"",title:t.time.toString()},on:{click:function(t){return e.mobile_editnote(r)}}})}))],2),n("van-tabbar",[n("van-tabbar-item",{attrs:{icon:"home-o"}},[e._v("录制")]),n("van-tabbar-item",{attrs:{icon:"search"}},[e._v("播放列表")]),n("van-tabbar-item",{attrs:{icon:"friends-o"}},[e._v("统计信息")]),n("van-tabbar-item",{attrs:{icon:"setting-o"}},[e._v("个人信息")])],1)],1):e._e()])},we=[],ge=n("54f8"),ye=(n("3ca3"),n("99af"),n("2b3d"),n("4de4"),n("cee5")),xe=n.n(ye),_e=n("cff8"),Re=n.n(_e),ke=n("c4e3"),Oe=n.n(ke),je=n("7f81"),Ie=n.n(je),Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("textarea",{on:{keydown:function(t){return e.down(t)},keyup:function(t){return e.up(t)}}})])},Ne=[],Te={data:function(){return{timelist:[]}},watch:{timelist:function(){console.log(this.timelist)}},methods:{down:function(e){this.timelist.push({code:e.code,type:"down"})},up:function(e){this.timelist.push({code:e.code,type:"up"})},get:function(){return this.timelist}}},Me=Te,$e=Object(l["a"])(Me,Se,Ne,!1,null,"a509bd70",null),Ee=$e.exports,Be=n("f564"),De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["point"==e.data.type?["title"in e.data.note?[e.data.note.title==e.data.note.desc&&e.data.note.desc==e.data.note.content?[n("div",[e._v("记录点:"+e._s(e.data.note.title))])]:[n("el-collapse",[n("el-collapse-item",{attrs:{name:"笔记信息",title:"笔记信息"}},[n("el-form",[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{attrs:{value:e.data.note.title,disabled:!0,placeholder:""}})],1),n("el-form-item",{attrs:{label:"简述"}},[n("el-input",{attrs:{value:e.data.note.desc,disabled:!0,placeholder:""}})],1)],1)],1)],1),n("mavon-editor",{staticStyle:{width:"100%"},style:{height:"60vh"},attrs:{subfield:!1,defaultOpen:"preview",editable:!1,toolbars:{}},model:{value:e.data.note.content,callback:function(t){e.$set(e.data.note,"content",t)},expression:"data.note.content"}})]]:[n("div",[e._v("标记点:"+e._s(e.data.time))])]]:"pause"==e.data.type?void 0:e._e()],2)},Ce=[],He={props:{data:{type:Object,default:{}}}},Le=He,Ue=Object(l["a"])(Le,De,Ce,!1,null,"05ba5049",null),Ae=Ue.exports,Pe="historyBlobs",Ye="historyBlobsInfoMap",ze="tempcache",Ve=Object(te["b"])(ze,ze),qe="recordingInfo";var Fe,Je,Xe={components:{TimeLineNote:Ee,SelectSource:I,ShowNote:Ae},name:"HelloWorld",props:{msg:String},watch:{selectMediaValue:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:null!=e.recordingInfo&&(e.recordingInfo.source=e.selectMediaValue);case 1:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.$mq),t.prev=1,e.loading=!0,e.loadHistoryIdx(),t.next=6,e.tempCacheEmpty();case 6:if(t.sent){t.next=14;break}return t.next=9,e.getTempRecordingInfo();case 9:n=t.sent,e.selectMediaValue=n.source,e.$nextTick(Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.startFormTempCache();case 2:case"end":return t.stop()}}),t)})))),t.next=16;break;case 14:return t.next=16,e.initRecorder();case 16:e.loading=!1,t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](1),e.loading=!1,e.$message.error("获取媒体设备错误");case 23:case"end":return t.stop()}}),t,null,[[1,19]])})))()},data:function(){return{mobile_show_selectsource:!1,active:"2",selectMediaValue:"mic",videoStreamUrl:null,nowEditNote:{content:"",title:"",desc:""},nowShowedNote:{},isShowingNote:!1,noteContentVisible:!1,isNoteEditing:!1,loading:!1,player:null,recordingInfo:{recordType:"audio",source:"",points:[]},startTime:new Date,endTime:new Date,nowRecordInfo:null,blobs:[],mergedBlob:null,recorder:null,src:"",historyBlobsIdx:[],historyInfoMap:{},nowState:"normal",showPlayer:!1,stopping:!1}},computed:{recordTime:function(){return q()(0).second(this.blobs.length).subtract(8,"hours").format("HH:mm:ss")}},asyncComputed:{playList:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.historyBlobsIdx.map(function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.readHistoryItem(n);case 2:return r=t.sent,t.abrupt("return",{name:e.historyInfoMap[n].name,id:n,size:r.size,length:e.historyInfoMap[n].length,startTime:e.historyInfoMap[n].startTime});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()}},methods:{mobile_editnote:function(e){var t=this.recordingInfo.points[e];Object(Be["a"])({type:"success",message:JSON.stringify(t)})},autoInit:function(){},sourceSelect:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_(e.selectMediaValue);case 2:n=t.sent,null==n&&Object(v["error"])("此媒體源不可用"),console.log(n),""!==e.selectMediaValue&&null!=n&&e.setSource(n);case 7:case"end":return t.stop()}}),t)})))()},setSource:function(e){if(null!=e){var t=e.type,n=e.stream;this.recordingInfo&&(this.recordingInfo.source=e.name),console.log(t),"audio"===t?(this.recordingInfo.recordType="audio",this.initRecorder(n)):"video"===t&&(this.recordingInfo.recordType="video",this.initVideoRecorder(n))}else Object(v["error"])("設置的媒體源無效")},initVideoRecorder:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.t0=e,n.t0){n.next=5;break}return n.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:!0});case 4:n.t0=n.sent;case 5:return r=n.t0,o=t.$refs["record_video_player"],o.srcObject=r,o.play(),a=15e5,n.next=12,t.$prompt("输入总码率（单位Mbps ，推荐1.5）:");case 12:i=n.sent,"confirm"==i.action&&(a=1e3*parseInt(i.value)*1e3),s=new MediaRecorder(r,{bitsPerSecond:a,audioBitrateMode:"variable",mimeType:"video/webm;codecs=vp9"}),s.ondataavailable=function(e){return t.dataavailable(e)},t.recorder=s;case 17:case"end":return n.stop()}}),n)})))()},initRecorder:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.t0=e,n.t0){n.next=5;break}return n.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 4:n.t0=n.sent;case 5:return r=n.t0,o=128e3,n.next=9,t.$prompt("输入音频码率（单位 kbps,推荐128）:");case 9:a=n.sent,"confirm"==a.action&&(o=1e3*parseInt(a.value)),i=new MediaRecorder(r,{bitsPerSecond:o,audioBitrateMode:"variable",mimeType:"audio/webm;codecs:opus"}),i.ondataavailable=function(e){return t.dataavailable(e)},t.recorder=i;case 14:case"end":return n.stop()}}),n)})))()},note_inputcontent:function(){this.noteContentVisible=!0},filesize:function(e){return xe()(e)},show_player:function(){this.showPlayer=!0},createPoint:function(e,t){var n=this.blobs.length,r=new Date;return{type:e,note:t,position:n,time:r}},formatDate:function(e){return q()(e).format("YYYY-MM-DD HH:mm:ss")},secondToTime:function(e){return q()(0).second(e).subtract(8,"hours").format("HH:mm:ss")},info_generate:function(e){var t=[],n=this.historyInfoMap[e];for(var r in n){var o="startTime"==r||"endTime"==r?this.formatDate(n[r]):"length"==r?this.secondToTime(n[r]):n[r];t.push("".concat(r,"：").concat(o))}return t},playlist_del:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.historyInfoMap[e],n.next=3,t.$confirm("是否要删除:"+r.name+"?");case 3:if(o=n.sent,"confirm"!=o){n.next=8;break}return e==t.nowRecordInfo.id&&t.clearNow(),n.next=8,t.removeItem(e);case 8:case"end":return n.stop()}}),n)})))()},playlist_download:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.historyInfoMap[e],t.$message.info("已开始下载："+r.name),n.t0=URL,n.next=5,t.readHistoryItem(e);case 5:return n.t1=n.sent,o=n.t0.createObjectURL.call(n.t0,n.t1),a=URL.createObjectURL(new Blob([JSON.stringify(r)])),n.next=10,t.downloadUrl(r.name+".webm",o);case 10:return URL.revokeObjectURL(o),n.next=13,t.downloadUrl(r.name+".json",a);case 13:URL.revokeObjectURL(r);case 14:case"end":return n.stop()}}),n)})))()},playlist_rename:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$prompt("请输入名称:","命名录音",{showCancelButton:!1,inputValue:t.historyInfoMap[e].name});case 2:if(r=n.sent,"confirm"!=r.action){n.next=8;break}return n.next=6,t.renameItem(e,r.value);case 6:n.next=10;break;case 8:return n.next=10,t.$alert("错误");case 10:case"end":return n.stop()}}),n)})))()},addPoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.createPoint("point",e);this.recordingInfo.points.push(t)},addNote:function(){this.isNoteEditing=!0},addBrief:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$prompt("输入记录描述(tips):","添加记录点");case 2:n=t.sent,"confirm"==n.action?(e.nowEditNote.title=n.value,e.nowEditNote.desc=n.value,e.nowEditNote.content=n.value,e.addPoint(e.nowEditNote)):e.clearNowEditNote();case 4:case"end":return t.stop()}}),t)})))()},clearNowEditNote:function(){this.nowEditNote={title:"",desc:"",content:""}},note_confirm:function(){this.addPoint(this.nowEditNote),this.isNoteEditing=!1,this.clearNowEditNote()},onnote_cancel:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("不保存笔记？");case 2:r=n.sent,"confirm"==r&&(t.clearNowEditNote(),e());case 4:case"end":return n.stop()}}),n)})))()},note_cancel:function(){var e=this;this.onnote_cancel((function(){e.isNoteEditing=!1}))},showRecordingPoint:function(e){var t=this.recordingInfo.points[e];this.$message(JSON.stringify(t)),this.nowShowedNote=t,this.isShowingNote=!0},play:function(){this.showPlayer=!0;var e=this.$refs.player;e.play()},play_pause:function(){var e=this.$refs.player;e.pause()},play_stop:function(){var e=this.$refs.player;e.fastSeek(0),this.play_pause()},select:function(e){var t=this;console.log(e),"recording"!=this.nowState&&"paused"!=this.nowState?(this.clearNow(),this.readHistoryItem(e).then((function(n){t.loadNow(e,n)}))):this.$message.error("不能在录音时进行播放，请先停止录音")},stateSwitch:function(e){this.nowState=e},dataavailable:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.stopping){n.next=2;break}return n.abrupt("return");case 2:return r=t.stopping,t.stopping&&(t.stopping=!1),t.blobs.push(e.data),t.endTime=new Date,console.log(e),n.next=9,t.addRecordFrame(e.data);case 9:return n.next=11,t.storeRecording();case 11:if(!r){n.next=14;break}return n.next=14,t.stop_after();case 14:case"end":return n.stop()}}),n)})))()},start:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.clearNow(),e.startTime=new Date,e.endTime=new Date,e.recorder.start(1e3),t.next=6,e.storeRecording();case 6:e.stateSwitch("recording");case 7:case"end":return t.stop()}}),t)})))()},getTempRecordingInfo:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Re.a.get(qe);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))()},startFormTempCache:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.tempCacheEmpty();case 2:if(!t.sent){t.next=4;break}throw new Error("不存在上次记录");case 4:return t.next=6,e.loadTempCache();case 6:return e.blobs=t.sent,t.next=9,Re.a.get(qe);case 9:n=t.sent,e.startTime=n["startTime"],e.endTime=n["endTime"],e.recordingInfo.points=n["points"],console.log(e.recorder),e.loading=!0,e.$watch("recorder",(function(){e.recorder&&(e.recorder.start(1e3),e.stateSwitch("recording"),e.pause()),e.loading=!1}),{immediate:!0});case 16:case"end":return t.stop()}}),t)})))()},storeRecording:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Re.a.set(qe,Object(A["a"])({startTime:e.startTime,endTime:e.endTime},e.recordingInfo));case 2:case"end":return t.stop()}}),t)})))()},addRecordFrame:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.blobs.length-1,n.next=3,Object(te["g"])(r,e,Ve);case 3:case"end":return n.stop()}}),n)})))()},resume:function(){var e=this.recorder;e.resume(),this.stateSwitch("recording")},pause:function(){var e=this.recorder;e.pause(),this.stateSwitch("paused")},clearTempCache:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(te["a"])(Ve);case 2:case"end":return e.stop()}}),e)})))()},tempCacheEmpty:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(te["e"])(0,Ve);case 2:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0==e.t1);case 5:case"end":return e.stop()}}),e)})))()},loadTempCache:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(te["d"])(Ve);case 2:return t=e.sent,t=t.sort((function(e,t){e[0],t[0]})),n=t.map((function(e){return e[1]})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))()},stop:function(){var e=this;this.recorder.stop(),this.stopping=!0,this.stop_after().then((function(){e.stopping=!1}))},stop_after:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(v["delay"])(0);case 2:return e.stateSwitch("merging"),e.mergeBlobs(e.blobs),e.pushToHistory(),t.next=7,e.clearTempCache();case 7:return e.stateSwitch("stopped"),t.next=10,e.$prompt("请输入名称:","命名录音",{showCancelButton:!1,inputValue:e.nowRecordInfo.id});case 10:if(n=t.sent,"confirm"!=n.action){t.next=23;break}return r=e.nowRecordInfo.id,t.next=15,e.renameItem(e.nowRecordInfo.id,n.value);case 15:return t.t0=e,t.t1=r,t.next=19,e.readHistoryItem(r);case 19:t.t2=t.sent,t.t0.loadNow.call(t.t0,t.t1,t.t2),t.next=25;break;case 23:return t.next=25,e.$alert("错误");case 25:case"end":return t.stop()}}),t)})))()},download:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""==e.src){t.next=7;break}return e.$message.info("已开始下载："+e.nowRecordInfo.name),e.downloadUrl(e.nowRecordInfo.name+".webm",e.src),n=URL.createObjectURL(new Blob([JSON.stringify(e.nowRecordInfo)])),t.next=6,e.downloadUrl(e.nowRecordInfo.name+".json",n);case 6:URL.revokeObjectURL(n);case 7:case"end":return t.stop()}}),t)})))()},downloadAll:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.$message.warning({message:"正在顺序下载所有内容",duration:0,showClose:!0}),r=Object(ge["a"])(e.historyBlobsIdx),t.prev=2,r.s();case 4:if((o=r.n()).done){t.next=10;break}return a=o.value,t.next=8,e.playlist_download(a);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),r.e(t.t0);case 15:return t.prev=15,r.f(),t.finish(15);case 18:n.close();case 19:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))()},downloadAll_packed:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,r,o,a,i,s,c,u,l,d,p,f,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("zip压缩下载有总大小限制，可能导致失败与卡顿，确定使用此方式下载吗（可选择专用格式）？");case 2:if(n=t.sent,"confirm"==n){t.next=5;break}return t.abrupt("return");case 5:r=e.$message.warning({message:"正在打包......",duration:0,showClose:!0}),o=new Oe.a,a=e.historyBlobsIdx,i=Object(ge["a"])(a),t.prev=10,i.s();case 12:if((s=i.n()).done){t.next=24;break}return c=s.value,u=o.folder(c),l=e.historyInfoMap[c],t.next=18,e.readHistoryItem(c);case 18:d=t.sent,u.file("".concat(c,".json"),Object(v["json"])(l)),u.file("".concat(c,".webm"),d),r.message="加入记录:".concat(c);case 22:t.next=12;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t["catch"](10),i.e(t.t0);case 29:return t.prev=29,i.f(),t.finish(29);case 32:return r.message="记录加入完成，正在进行压缩......",p=e.$message.info({message:"进度:0",duration:0,showClose:!1}),t.next=36,o.generateAsync({type:"blob",compression:"STORE"},(function(e){p.message="进度:".concat(e.percent," \n 已压缩:").concat(e.currentFile)}));case 36:return f=t.sent,m=URL.createObjectURL(f),r.close(),e.$message.warning("已经开始下载打包文件"),t.next=42,e.downloadUrl("packageRecords.zip",m);case 42:URL.revokeObjectURL(m);case 43:case"end":return t.stop()}}),t,null,[[10,26,29,32]])})))()},downloadAll_packed_private:function(){this.$msgbox("尚未实现此功能，敬请期待")},removeNow:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.playlist_del(e.nowRecordInfo.id);case 2:case"end":return t.stop()}}),t)})))()},clear:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("确定要清除所有记录吗?",{type:"warning"});case 2:n=t.sent,"confirm"==n&&e.clearHistroy();case 4:case"end":return t.stop()}}),t)})))()},downloadUrl:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=new Ie.a({url:t,filename:e}),n.next=3,r;case 3:case"end":return n.stop()}}),n)})))()},mergeBlobs:function(e){var t=new Blob(e,{type:"audio/webm"});this.src=URL.createObjectURL(t),this.mergedBlob=t;var n="record_".concat(q()(this.startTime).format("YYYY-MM-DD hh:mm:ss"),"_").concat(q()(this.endTime).format("YYYY-MM-DD hh:mm:ss"));this.nowRecordInfo=Object(A["a"])({name:n,id:n,startTime:this.startTime,endTime:this.endTime,timeSpanList:[],length:e.length},this.recordingInfo)},clearNow:function(){null!=this.src&&""!=this.src&&(URL.revokeObjectURL(this.src),this.src="",this.mergedBlob=null,this.blobs=[],this.nowRecordInfo=null,this.recordingInfo.points=[])},loadNow:function(e,t){this.clearNow(),this.mergedBlob=t,this.blobs=[],this.nowRecordInfo=this.historyInfoMap[e],this.src=URL.createObjectURL(t)},pushToHistory:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(-1==e.historyBlobsIdx.indexOf(e.nowRecordInfo.id)){t.next=2;break}throw new Error("已经存在同名历史记录");case 2:if(null!=e.mergedBlob&&null!=e.nowRecordInfo.id){t.next=4;break}throw new Error("错误调用");case 4:return t.next=6,e.addItem(e.nowRecordInfo,e.mergedBlob);case 6:case"end":return t.stop()}}),t)})))()},addItem:function(e,t){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n.historyBlobsIdx.push(e.id),Re()(Pe,n.historyBlobsIdx),n.historyInfoMap[e.id]=e,Re()(Ye,n.historyInfoMap),r.next=6,Object(te["g"])(Pe+e.id,t);case 6:case"end":return r.stop()}}),r)})))()},loadHistoryIdx:function(){Re.a.has(Pe)?this.historyBlobsIdx=Re.a.get(Pe):this.historyBlobsIdx=[],Re.a.has(Ye)?this.historyInfoMap=Re.a.get(Ye):this.historyInfoMap={}},clearHistroy:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=Object(ge["a"])(e.historyBlobsIdx),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=9;break}return o=r.value,t.next=7,Object(te["c"])(Pe+o);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:Re.a.remove(Pe),Re.a.remove(Ye),e.clearNow(),e.loadHistoryIdx();case 21:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})))()},readHistoryItem:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(-1!=t.historyBlobsIdx.indexOf(e)){n.next=2;break}throw new Error("记录"+e+"不存在");case 2:return n.next=4,Object(te["e"])(Pe+e);case 4:return r=n.sent,n.abrupt("return",r);case 6:case"end":return n.stop()}}),n)})))()},removeItem:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(-1!=t.historyBlobsIdx.indexOf(e)){n.next=2;break}throw new Error("没有这个记录");case 2:return t.historyBlobsIdx=t.historyBlobsIdx.filter((function(t){return t!=e})),delete t.historyInfoMap[e],Re.a.set(Ye,t.historyInfoMap),Re.a.set(Pe,t.historyBlobsIdx),n.next=8,Object(te["c"])(Pe+e);case 8:case"end":return n.stop()}}),n)})))()},renameItem:function(e,t){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(-1!=n.historyBlobsIdx.indexOf(e)){r.next=2;break}throw new Error("没有这个记录");case 2:return r.next=4,n.readHistoryItem(e);case 4:return o=r.sent,a=n.historyInfoMap[e],r.next=8,n.removeItem(e);case 8:return a.name=t,r.next=11,n.addItem(a,o);case 11:case"end":return r.stop()}}),r)})))()}}},Ge=Xe,We=(n("f550"),Object(l["a"])(Ge,be,we,!1,null,"54853b54",null)),Ke=We.exports,Qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ul",e._l(e.historyInfos,(function(t,r){return n("li",{key:r},[e._v(e._s(JSON.stringify(t)))])})),0),e._v(" "+e._s(e.recordingLength)+" "),n("el-button",{on:{click:e.startNew}},[e._v("开始")]),n("el-button",{on:{click:e.resume}},[e._v("继续")]),n("el-button",{on:{click:e.pause}},[e._v("暂停")]),n("el-button",{on:{click:function(t){return e.saveRecording()}}},[e._v("开始")])],1)},Ze=[],et={data:function(){return{}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ensureInitHistory();case 2:case"end":return t.stop()}}),t)})))()},computed:Object(A["a"])(Object(A["a"])(Object(A["a"])({},Object(U["d"])("recorder",["recordingLength"])),Object(U["d"])("history",["historyIdxs"])),Object(U["e"])("history",["historyInfos"])),methods:Object(A["a"])(Object(A["a"])({},Object(U["c"])("recorder",["startNew","pause","saveRecording","resume"])),Object(U["c"])("history",["ensureInitHistory"]))},tt=et,nt=Object(l["a"])(tt,Qe,Ze,!1,null,"402d414c",null),rt=nt.exports,ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v(" "+e._s(e.countA)+" "+e._s(e.hello)+" "),n("el-button",{attrs:{type:"primary"},on:{click:e.test}},[e._v("+1")]),n("div",[e._v(" "+e._s(e.countAdd)+" ")])],1)},at=[],it=n("2c4c"),st=n("920b"),ct=n("92a6"),ut=n("2fe1"),lt=(Fe=Object(ut["a"])({computed:Object(A["a"])(Object(A["a"])({},Object(U["e"])(["countA"])),{},{hello:function(){return this.countAdd+this.$store.state.countA}})}),Fe(Je=function(e){Object(st["a"])(n,e);var t=Object(ct["a"])(n);function n(){var e;Object(P["a"])(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),Object(ee["a"])(Object(it["a"])(e),"count",0),e}return Object(Y["a"])(n,[{key:"countAdd",get:function(){return this.count+1}},{key:"test",value:function(){this.count++,this.$store.commit("increment")}},{key:"mounted",value:function(){alert("hello")}}]),n}(r["default"]))||Je),dt=lt,pt=dt,ft=Object(l["a"])(pt,ot,at,!1,null,"b151066e",null),mt=ft.exports,ht=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AuthingGuard",{attrs:{appId:"60ace8a7de8081b582bbaf6e"},on:{login:e.login}})],1)},vt=[],bt=n("8c7e"),wt=(n("c2ad"),{components:{AuthingGuard:bt["AuthingGuard"]},methods:{login:function(e){console.log(e),this.$router.push({path:"/"})}}}),gt=wt,yt=Object(l["a"])(gt,ht,vt,!1,null,"76c495ac",null),xt=yt.exports,_t=n("b2d8"),Rt=n.n(_t),kt=(n("64e1"),n("660e"));r["default"].config.productionTip=!1,r["default"].use($),r["default"].use(E["a"]),r["default"].use(B["a"]),r["default"].use(H["a"]),r["default"].use(U["b"]);var Ot=he();r["default"].use(ve["a"]);var jt=[{path:"/login",component:xt},{path:"/",component:Ke},{path:"/center",component:mt},{path:"/new",component:rt}],It=new ve["a"]({routes:jt});r["default"].use(C.a,{name:"ls",bind:!0}),r["default"].use(Rt.a),r["default"].use(kt["a"],{breakpoints:{sm:450,md:950,lg:1/0},defaultBreakpoint:"sm"});var St=document.createElement("div");document.body.append(St),new r["default"]({render:function(e){return e(M)},store:Ot,router:It,el:St})},f550:function(e,t,n){"use strict";n("05c1")}});
//# sourceMappingURL=app.1d6b35d5.js.map