(function(e){function t(t){for(var n,i,s=t[0],c=t[1],u=t[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);l&&l(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={app:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},1:function(e,t){},"29d8":function(e,t,r){"use strict";r("9a51")},7152:function(e,t,r){},7863:function(e,t,r){"use strict";r("7152")},"8ae7":function(e,t,r){},"9a51":function(e,t,r){},b044:function(e,t,r){"use strict";r("8ae7")},cc16:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return u}));var n=r("c964"),a=r("276c"),o=r("e954"),i=(r("96cf"),r("d3b7"),r("3717")),s=r.n(i),c=function(){function t(e){Object(a["a"])(this,t),this.fs=e,this.createReadStream=this.fs.createReadStream,this.createWriteStram=this.fs.createWriteStream}return Object(o["a"])(t,[{key:"writeFile",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("id:",t),e.abrupt("return",new Promise((function(e,a){n.fs.writeFile(t,r,(function(t){t&&a(t),e()}))})));case 2:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"exists",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return r.fs.exists(t,(function(t){return e(t)}))})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"open",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){n.fs.open(t,r,(function(t,r){t&&a(t),e(r)}))})));case 1:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"read",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r,n,a){var o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){var s=new e(n);o.fs.read(r,s,0,n,a,(function(e,r,n){e&&i(e),t(n)}))})));case 1:case"end":return t.stop()}}),t)})));function r(e,r,n){return t.apply(this,arguments)}return r}()},{key:"fstat",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){r.fs.fstat(t,(function(t,r){t&&n(t),e(r)}))})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"readFile",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){r.fs.readFile(t,(function(t,r){t&&n(t),e(r)}))})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"readdir",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){r.fs.readdir(t,(function(t,r){t&&n(t),e(r)}))})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"unlink",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){r.fs.unlink(t,(function(t){t&&n(t),e()}))})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mkdir",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){r.fs.mkdir(t,(function(t){t&&n(t),e()}))})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(),u=function(){function e(){Object(a["a"])(this,e),this.fs=new c(window.require("fs")),this.buffer=window.require("buffer").Buffer,this.path=window.require("path")}return Object(o["a"])(e,[{key:"writeToFile",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.arrayBuffer();case 2:return n=e.sent,a=this.buffer.from(n),e.abrupt("return",this.fs.writeFile(t,a));case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getAllFiles",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fs.readdir(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"ensureDir",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fs.exists(t);case 2:if(!e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.fs.mkdir(t);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"readFile",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fs.readFile(t);case 2:if(r=e.sent,!r){e.next=5;break}return e.abrupt("return",new Blob([r.buffer]));case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delFile",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fs.exists(t);case 2:if(!e.sent){e.next=5;break}return e.next=5,this.fs.unlink(t);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"downloadFile",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,i,c,u,l,d,f,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fs.exists(t);case 2:if(!e.sent){e.next=36;break}return e.next=5,this.fs.open(t,"r");case 5:if(n=e.sent,!n){e.next=35;break}return a=s.a.createWriteStream(r),o=a.getWriter(),e.next=11,this.fs.fstat(n);case 11:if(i=e.sent,void 0!=i){e.next=14;break}return e.abrupt("return",!1);case 14:c=i.size,u=1e3,l=0;case 17:if(!(l<c)){e.next=30;break}return d=Math.min(l+u,c),f=d-l,e.next=22,this.fs.read(n,f,l);case 22:if(p=e.sent,void 0!=p){e.next=25;break}return e.abrupt("return",!1);case 25:return e.next=27,o.write(p);case 27:l+=u,e.next=17;break;case 30:return e.next=32,o.close();case 32:return e.abrupt("return",!0);case 35:return e.abrupt("return",!1);case 36:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}()}).call(this,r("b639").Buffer)},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",[r("router-view")],1),r("div",{staticStyle:{height:"100px"}}),r("div",{staticStyle:{padding:"24px"}},[r("Vssue",{attrs:{title:"title",options:e.option}})],1)])},o=[],i=r("f3f3"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"cont",staticClass:"container",staticStyle:{background:"green"},style:{left:e.x+"px",top:e.y+"px"},on:{mouseover:function(t){return e.enter(t)},mouseout:function(t){return e.leave(t)},mousedown:function(t){return e.down(t)}}},[e._t("default")],2)},c=[],u={data:function(){return{x:0,y:0,beforeDrag:!1,draging:!1,dragX:0,dragY:0}},mounted:function(){var e=this;document.addEventListener("mousemove",(function(t){return e.move(t)})),document.addEventListener("mouseup",(function(t){return e.up(t)}))},methods:{isdrag:function(e){var t=e.target.dataset["draggable"];return!!t},enter:function(e){this.draging||this.isdrag(e)&&(this.beforeDrag=!0,this.draging=!1)},leave:function(e){this.draging||this.isdrag(e)&&(this.beforeDrag=!1,this.draging=!1)},move:function(e){this.draging&&(this.x=e.clientX-this.dragX,this.y=e.clientY-this.dragY,console.log(this.dragX,this.dragY))},down:function(e){if(e.currentTarget==this.$refs["cont"]){var t=e.currentTarget.getBoundingClientRect();this.dragX=e.clientX-t.left,this.dragY=e.clientY-t.top,console.log(this.dragX,this.dragY)}this.isdrag(e)&&this.beforeDrag&&(this.beforeDrag=!1,this.draging=!0)},up:function(e){this.draging&&(this.beforeDrag=!0,this.draging=!1),this.effect()},effect:function(){this.x<0&&(this.x=0),Math.abs(this.x)<20&&(this.x=0),Math.abs(this.y)<20&&(this.x=0)}}},l=u,d=(r("29d8"),r("2877")),f=Object(d["a"])(l,s,c,!1,null,"487e012f",null),p=f.exports,m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["sm"!=e.$mq?r("el-form",[r("el-form-item",{attrs:{label:"媒体源"}},[r("el-select",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.medianames,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1):e._e(),"sm"==e.$mq?r("div",[r("van-picker",{attrs:{title:"选择媒体源","show-toolbar":"",columns:e.selectList},on:{confirm:e.select}})],1):e._e()],1)},h=[],w=r("c964"),b=(r("96cf"),r("d81d"),r("b0c0"),r("3ad6")),v=r("2ef0"),g=r.n(v);function x(e){return y.apply(this,arguments)}function y(){return y=Object(w["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r={mic:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getUserMedia({audio:!0,video:!1}));case 1:case"end":return e.stop()}}),e)})))()},capture:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getUserMedia({audio:!0,video:!0}));case 1:case"end":return e.stop()}}),e)})))()},screen:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}));case 1:case"end":return e.stop()}}),e)})))()},audiooutput:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0});case 2:return t=e.sent,r=t.getAudioTracks(),console.log(r),e.abrupt("return",new MediaStream(r));case 6:case"end":return e.stop()}}),e)})))()}},t in r!==!1){e.next=3;break}return e.abrupt("return",null);case 3:return e.prev=3,e.next=6,r[t]();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e["catch"](3),Object(b["error"])("此媒体源不可用，请切换媒体源");case 12:case"end":return e.stop()}}),e,null,[[3,9]])}))),y.apply(this,arguments)}var k={mic:"audio",capture:"video",screen:"video",audiooutput:"audio"};function R(e){return O.apply(this,arguments)}function O(){return O=Object(w["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:return e.t0=e.sent,e.t1=t,e.t2=k[t],e.abrupt("return",{stream:e.t0,name:e.t1,type:e.t2});case 6:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}var _={props:{value:{type:String,default:""}},data:function(){return{selected:"",medianames:[{name:"麦克风（音频）",value:"mic"},{name:"摄像头（视频+音频）",value:"capture"},{name:"录屏(视频+电脑内音频）",value:"screen"},{name:"内部音源(电脑内音频）",value:"audiooutput"}]}},computed:{selectList:function(){return this.medianames.map((function(e){return e.name}))}},methods:{select:function(e,t){var r=this.medianames[t];this.selected=r.value}},watch:{value:function(){this.selected=this.value},selected:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$emit("update:value",e.selected),e.$emit("select");case 2:case"end":return t.stop()}}),t)})))()}}},j=_,I=Object(d["a"])(j,m,h,!1,null,null,null),S=I.exports,N=r("ffa6"),B=(r("7d30"),r("9d2a")),T={clientId:"a66e7b749c1ec58019db",clientSecret:"099d2fb4b68dc287c0e13b0b05d5ece39f329bdf"},E={components:{GWidget:p,SelectSource:S,Vssue:N["a"]},name:"App",data:function(){return{active:"2",option:Object(i["a"])({api:B["a"],owner:"gmono",repo:"offline-recorder-comments"},T)}}},M=E,D=(r("b044"),Object(d["a"])(M,a,o,!1,null,null,null)),$=D.exports,H=r("5c96"),C=(r("0fae"),r("b970")),P=(r("157a"),r("4380")),L=r("ead5"),U=r.n(L),A=r("3003"),Y=r("9483");Object(Y["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var F=r("2f62"),z=r("276c"),V=r("e954"),q=r("ec26"),W=r("5a0c"),X=r.n(W),J=r("2bd2");function G(){return{id:"record_".concat(Object(q["a"])()),name:"record_".concat(X()().format("YYYY-MM-DD HH:mm:ss")),startTime:new Date,endTime:new Date,points:[]}}function K(e){var t=Q();return t.type="pause",t.data={pause_type:e,time:new Date},t}function Q(){return{type:"point",data:null}}var Z=function(){function e(){Object(z["a"])(this,e),this.recorder=null,this.onDataAvailable=new J["a"]}return Object(V["a"])(e,[{key:"ensureinit",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==this.recorder){e.next=2;break}return e.abrupt("return");case 2:return t=navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),e.t0=MediaRecorder,e.next=6,t;case 6:e.t1=e.sent,e.t2={bitsPerSecond:128e3,audioBitrateMode:"variable",mimeType:"audio/webm"},r=new e.t0(e.t1,e.t2),this.recorder=r,r.addEventListener("dataavailable",(function(e){return n.onDataAvailable.next(e.data)}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),ee=new Z,te=null,re=function(){return{state:{mergedBlob:null,blobs:[],state:"normal",recordingInfo:null},mutations:{mergeBlob:function(e){e.mergedBlob=new Blob(e.blobs),e.blobs=[]},pushBlob:function(e,t){console.log("receive"),"recording"==e.state?e.blobs.push(t):console.error("状态错误，丢弃1帧")},addCheckPoint:function(e,t){if(null==e.recordingInfo)throw new Error("录制信息不存在，可能还没开始录音");e.recordingInfo.points.push(t)},setRecordingName:function(e,t){e.recordingInfo.name=t},switchState:function(e,t){switch(e.state){case"normal":"start"==t?(e.state="recording",e.recordingInfo=G()):Object(b["error"])("state和action不匹配");break;case"recording":if("pause"==t){e.state="paused";var r=K("pause");e.recordingInfo.points.push(r)}else"stop"==t?e.state="stopped":Object(b["error"])("state和action不匹配");break;case"paused":"stop"==t?e.state="stopped":"start"==t?(e.state="recording",e.recordingInfo.points.push(K("pause_resume"))):Object(b["error"])("state和action不匹配");break;case"stopped":"recover"==t?(e.state="normal",e.blobs=[],e.recordingInfo=null,e.mergedBlob=null):Object(b["error"])("state和action不匹配");break}}},getters:{recordingLength:function(e){return null==e.recordingInfo?null:e.blobs.length},historyBlobs:function(e){}},actions:{newRecorder:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},startNew:function(e){return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ee.ensureinit();case 2:"normal"==e.state.state?(e.commit("switchState","start"),te=ee.onDataAvailable.subscribe((function(t){e.commit("pushBlob",t)})),ee.recorder.start(1e3)):Object(b["error"])("还没恢复到未开始状态");case 3:case"end":return t.stop()}}),t)})))()},resume:function(e){return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ee.ensureinit();case 2:if("paused"==e.state.state){t.next=5;break}return Object(b["error"])("并非在暂停状态，调用resume"),t.abrupt("return");case 5:e.commit("switchState","start"),ee.recorder.resume();case 7:case"end":return t.stop()}}),t)})))()},pause:function(e){return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit("switchState","pause"),t.next=3,ee.ensureinit();case 3:ee.recorder.pause();case 4:case"end":return t.stop()}}),t)})))()},saveRecording:function(e,t){return Object(w["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.commit("switchState","stop"),r.next=3,ee.ensureinit();case 3:return ee.recorder.stop(),te.unsubscribe(),te=null,null!=t&&e.commit("setRecordingName",t),r.next=9,e.dispatch("storeToDisk");case 9:e.dispatch("tempcache/clearCache",null,{root:!0}),e.commit("switchState","recover");case 11:case"end":return r.stop()}}),r)})))()},storeToDisk:function(e){return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return null==e.state.mergedBlob&&e.commit("mergeBlob"),t.next=3,e.dispatch("history/ensureInitHistory",null,{root:!0});case 3:return t.next=5,e.dispatch("history/pushHistory",{info:e.state.recordingInfo,blob:e.state.mergedBlob},{root:!0});case 5:case"end":return t.stop()}}),t)})))()},pushFrame:function(e,t){return Object(w["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.commit("pushBlob",t),e.dispatch("tempcache/pushItem",t,{root:!0});case 2:case"end":return r.stop()}}),r)})))()}}}},ne=r("fc11"),ae=(r("d3b7"),r("ddb0"),r("13d5"),r("edfe")),oe=Object(ae["b"])("items","recording"),ie=Object(ae["b"])("infos","recording");function se(){return ce.apply(this,arguments)}function ce(){return ce=Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(ae["d"])(ie);case 2:return e.next=4,e.sent.reduce((function(e,t){return e[t[0]]=t[1],e}),{});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),ce.apply(this,arguments)}function ue(e){return le.apply(this,arguments)}function le(){return le=Object(w["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(ae["e"])(t,oe);case 2:if(r=e.sent,!r){e.next=7;break}return e.abrupt("return",r);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}function de(e,t){return fe.apply(this,arguments)}function fe(){return fe=Object(w["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,Object(ae["g"])(n,r,oe);case 3:return e.next=5,Object(ae["g"])(n,t,ie);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)}))),fe.apply(this,arguments)}function pe(e){return me.apply(this,arguments)}function me(){return me=Object(w["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(ae["c"])(t,oe);case 2:return e.next=4,Object(ae["c"])(t,ie);case 4:case"end":return e.stop()}}),e)}))),me.apply(this,arguments)}function he(){return we.apply(this,arguments)}function we(){return we=Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(ae["a"])(ie);case 2:return e.next=4,Object(ae["a"])(oe);case 4:case"end":return e.stop()}}),e)}))),we.apply(this,arguments)}var be=function(){return{state:{isInited:!1,historyInfos:null},getters:{historyIdxs:function(e){return g.a.keys(e.historyInfos)}},mutations:{addHistoryItem:function(e,t){0==e.isInited&&Object(b["error"])("错误，还没初始化"),e.historyInfos=Object(i["a"])(Object(i["a"])({},e.historyInfos),{},Object(ne["a"])({},t.id,t)),alert(t)},initHistoryInfo:function(e,t){e.isInited=!0,e.historyInfos=g.a.cloneDeep(t)},removeItem:function(e,t){0==context.state.isInited&&Object(b["error"])("错误，还没初始化"),t in e.historyInfos&&delete e.historyInfos[t]},updateInfo:function(e,t){var r=t.id,n=t.newInfo;0==e.isInited&&Object(b["error"])("错误，还没初始化"),r!=n.id&&Object(b["error"])("不能更新Item的id，id不可更改"),r in e.historyInfos&&(e.historyInfos[r]=n)}},actions:{pushHistory:function(e,t){return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.info,a=t.blob,r.next=3,de(n,a);case 3:e.commit("addHistoryItem",n);case 4:case"end":return r.stop()}}),r)})))()},removeHistory:function(e,t){return Object(w["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,pe(t);case 2:e.commit("removeItem",t);case 3:case"end":return r.stop()}}),r)})))()},renameHistory:function(e,t){return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=t.id,a=t.newName,0==e.state.isInited&&Object(b["error"])("错误，还没初始化"),o=e.state.historyInfos[n],o.name=a,e.commit("updateInfo",{id:n,newInfo:o});case 5:case"end":return r.stop()}}),r)})))()},clearHistory:function(e){return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,he();case 2:e.commit("initHistoryInfo",{});case 3:case"end":return t.stop()}}),t)})))()},ensureInitHistory:function(e){return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.state.isInited){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,se();case 4:r=t.sent,e.commit("initHistoryInfo",r);case 6:case"end":return t.stop()}}),t)})))()},getItem:function(e,t){return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(t in e.state.historyInfos)){r.next=9;break}if(n=e.state.historyInfos[t],a=ue(t),null!=n&&null!=a){r.next=6;break}return console.error("获取记录时出现错误，存在空记录"),r.abrupt("return",null);case 6:return r.abrupt("return",{info:n,blob:a});case 9:return r.abrupt("return",null);case 10:case"end":return r.stop()}}),r)})))()}}}},ve=function(){return new F["a"]({modules:{recorder:Object(i["a"])({namespaced:!0},re()),history:Object(i["a"])({namespaced:!0},be())}})},ge=r("8c4f"),xe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"hello"},["md"==e.$mq||"lg"==e.$mq?r("div",{staticClass:"pcui"},[r("el-dialog",{attrs:{fullscreen:"",title:"查看记录",visible:e.isShowingNote},on:{"update:visible":function(t){e.isShowingNote=t},keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.isShowingNote=!1}}},[r("show-note",{attrs:{data:e.nowShowedNote}}),r("el-divider"),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isShowingNote=!1}}},[e._v("关闭")])],1),r("h1",[e._v("离线录制")]),r("h4",[e._v("一款直接在浏览器中运行的录音机，数据离线实时保存（尚未适配手机）")]),r("div",{staticClass:"inner-card"},[r("el-collapse",{attrs:{accordion:""},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[r("el-collapse-item",{attrs:{name:"1"}},[r("template",{slot:"title"},[r("div",{staticStyle:{"padding-left":"2rem"}},[e._v("功能")])]),r("h3",[e._v(" 断电，关闭浏览器或录音时间过长超出内存等问题，都不丢失数据，重新打开继续录 ")]),r("h3",[e._v("数据保存在浏览器中，存储在本地电脑上，保护隐私")]),r("h3",[e._v("支持同时录多份录音文件，不会出现不下载就消失的情况")]),r("h3",[e._v("在线播放器，可在线预览，选择下载")]),r("h3",[e._v("自动记录额外信息，如录音时间段，长度大小等")]),r("h3",[e._v(' 可添加为WebApp（打开Chrome浏览器点击地址栏右侧“安装recorder"，手机可打开手机版Chrome后，根据底部提示操作） ')])],2),r("el-collapse-item",{attrs:{name:"2"}},[r("template",{slot:"title"},[r("div",{staticStyle:{"padding-left":"2rem"}},[e._v("注意事项")])]),r("h3",[e._v(" 切记本录音机不能在同一浏览器上同时打开两个，否则会造成存储混乱，对数据产生不可预测破坏 ")]),r("h3",[e._v("请勿清除浏览器记录，录音文件及时下载防止丢失")]),r("h3",[e._v(" 录音占用空间过大或一次录音时间过长时可能发生存储加载延迟，出现播放列表短暂不显示，等待一段时间即可 ")]),r("h3",[e._v(" 请不要在一个录音中使用多个源（目前版本），例如如果录屏，就一直使用录屏的视频源，中断后继续时也一样，不要切换到摄像头 ")])],2)],1)],1),r("div",{staticStyle:{"margin-top":"2rem"}}),r("div",[r("el-dialog",{attrs:{visible:e.showPlayer,fullscreen:""},on:{"update:visible":function(t){e.showPlayer=t}}},[r("div",{staticClass:"player"},[r("div",{staticClass:"player_info"},[r("h3",[e._v(" 当前录音:"+e._s(null==e.nowRecordInfo?"无":e.nowRecordInfo.name)+" ")]),null!=e.nowRecordInfo?r("div",[r("el-card",{attrs:{shadow:"never"}},[r("div",[e._v("名称:"+e._s(e.nowRecordInfo["name"]))]),r("div",[e._v("类型:"+e._s(e.nowRecordInfo["recordType"]))]),r("div",[e._v("ID:"+e._s(e.nowRecordInfo["id"]))]),r("div",[e._v("长度:"+e._s(e.secondToTime(e.nowRecordInfo["length"])))]),r("div",[e._v(" 开始时间:"+e._s(e.formatDate(e.nowRecordInfo["startTime"]))+" ")]),r("div",[e._v("结束时间:"+e._s(e.formatDate(e.nowRecordInfo["endTime"])))]),r("el-collapse",[r("el-collapse-item",{attrs:{name:"笔记列表",title:"笔记列表"}},[r("note-list",{attrs:{points:e.nowRecordInfo.points}})],1)],1)],1)],1):e._e(),r("div",{staticStyle:{"margin-top":"2rem"}}),r("div",[r("video",{ref:"player",staticStyle:{outline:"none","max-width":"100%"},attrs:{src:e.src,controls:""}})]),r("div",{staticStyle:{"margin-top":"2rem"}}),r("div",[r("el-button",{staticStyle:{margin:"2rem"},attrs:{type:"success"},on:{click:e.download}},[e._v("下载")]),r("el-dropdown",{staticStyle:{margin:"2rem"}},[r("el-button",{attrs:{type:"success"},on:{click:e.downloadAll}},[e._v(" 下载全部（悬浮查看更多）"),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{on:{click:e.downloadAll_packed}},[e._v("打包下载全部（zip）")]),r("el-dropdown-item",{on:{click:e.downloadAll_packed_private}},[e._v("打包下载全部（专用格式）")])],1)],1),r("el-button",{staticStyle:{margin:"2rem"},attrs:{type:"primary"},on:{click:e.clear}},[e._v("清除历史记录")])],1)]),r("div",{staticClass:"player_list"},[r("el-table",{attrs:{"max-height":"600",border:"",data:e.playList}},[r("el-table-column",{attrs:{label:"名称",prop:"name",sortable:""}}),r("el-table-column",{attrs:{label:"开始时间",width:"160px",prop:"startTime",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(e._s(e.formatDate(t.row.startTime)))])]}}],null,!1,2415485106)}),r("el-table-column",{attrs:{width:"130px",label:"大小",prop:"size",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(e._s(e.filesize(t.row.size)))])]}}],null,!1,2937803542)}),r("el-table-column",{attrs:{width:"100px",label:"长度",prop:"length",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(e._s(e.secondToTime(t.row.length)))])]}}],null,!1,4061846994)}),r("el-table-column",{attrs:{label:"操作",align:"right","header-align":"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.select(t.row.id)}}},[e._v("查看")]),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return e.playlist_del(t.row.id)}}},[e._v("删除")]),r("el-button",{attrs:{type:"success",size:"small"},on:{click:function(r){return e.playlist_download(t.row.id)}}},[e._v("下载")]),r("el-button",{attrs:{type:"info",size:"small"},on:{click:function(r){return e.playlist_rename(t.row.id)}}},[e._v("重命名")])]}}],null,!1,158870327)})],1)],1)])]),r("el-dialog",{staticClass:"notedialog",attrs:{title:"输入内容",visible:e.noteContentVisible,width:"70%",fullscreen:"md"==e.$mq},on:{"update:visible":function(t){e.noteContentVisible=t}}},[r("mavon-editor",{staticStyle:{width:"100%"},style:{height:"60vh"},model:{value:e.nowEditNote.content,callback:function(t){e.$set(e.nowEditNote,"content",t)},expression:"nowEditNote.content"}})],1),r("el-dialog",{attrs:{"show-close":!1,title:"输入笔记",visible:e.isNoteEditing,width:"70%",fullscreen:"md"==e.$mq,"before-close":e.onnote_cancel},on:{"update:visible":function(t){e.isNoteEditing=t}}},[r("el-form",[r("el-form-item",{attrs:{label:"标题"}},[r("el-input",{attrs:{autofocus:""},model:{value:e.nowEditNote.title,callback:function(t){e.$set(e.nowEditNote,"title",t)},expression:"nowEditNote.title"}})],1),r("el-form-item",{attrs:{label:"简要描述"}},[r("el-input",{model:{value:e.nowEditNote.desc,callback:function(t){e.$set(e.nowEditNote,"desc",t)},expression:"nowEditNote.desc"}})],1),r("el-form-item",{staticStyle:{display:"flex","flex-direction":"row-reverse"}},[r("span",{staticStyle:{"margin-right":"3rem","font-size":"16px","font-weight":"bold"}},[e._v("已输入:"+e._s(e.nowEditNote.content.length)+"字")]),r("el-button",{attrs:{type:"primary"},on:{click:e.note_inputcontent}},[e._v("输入内容")])],1)],1),r("el-row",{staticStyle:{"margin-top":"1.5rem",display:"flex","justify-content":"space-around"}},[r("el-button",{on:{click:e.note_cancel}},[e._v("取消")]),r("el-button",{attrs:{type:"success"},on:{click:e.note_confirm}},[e._v("确认")])],1)],1),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.stopping||e.loading,expression:"stopping || loading"}],staticClass:"recorder"},[r("div",[r("video",{directives:[{name:"show",rawName:"v-show",value:"video"==e.recordingInfo.recordType,expression:"recordingInfo.recordType == 'video'"}],ref:"record_video_player",staticStyle:{"max-width":"100%"}})]),r("el-row",{staticStyle:{"margin-top":"1.5rem",display:"flex","justify-content":"flex-end",height:"2.5rem","margin-right":"2.5rem"}},[r("select-source",{staticStyle:{width:"300px"},attrs:{value:e.selectMediaValue},on:{"update:value":function(t){e.selectMediaValue=t},select:e.sourceSelect}})],1),r("el-divider"),r("el-row",[r("h2",[e._v("当前录制:"+e._s(e.recordTime))]),null==e.recorder?r("el-row",[r("h3",[e._v("当前设备尚未初始化，请选择媒体完成初始化")])]):e._e(),r("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px",display:"flex",justifyContent:"flex-end","margin-right":"25px"}},[r("el-button",{attrs:{type:"danger"},on:{click:e.forceDownload}},[e._v(" 紧急下载(下载缓存) ")])],1),null!=e.recorder?r("el-row",["normal"==e.nowState||"stopped"==e.nowState?r("el-button",{attrs:{type:"success"},on:{click:e.start}},[e._v("开始")]):e._e(),"paused"==e.nowState?r("el-button",{attrs:{type:"success"},on:{click:e.resume}},[e._v("继续")]):e._e(),"recording"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.pause}},[e._v("暂停")]):e._e(),"recording"==e.nowState||"paused"==e.nowState?r("el-button",{attrs:{type:"danger"},on:{click:e.stop}},[e._v("停止")]):e._e(),"stopped"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.play}},[e._v("播放")]):e._e(),"stopped"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.download}},[e._v("下载当前录音")]):e._e(),"stopped"==e.nowState?r("el-button",{attrs:{type:"danger"},on:{click:e.removeNow}},[e._v("删除")]):e._e(),r("el-button",{attrs:{type:"warning"},on:{click:e.show_player}},[e._v("显示播放器")]),r("el-divider"),"recording"==e.nowState?r("el-button",{staticStyle:{"margin-right":"2rem"},attrs:{type:"primary"},on:{click:e.addPoint}},[e._v("添加标记点(空格键添加)")]):e._e(),"recording"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.addNote}},[e._v("添加笔记")]):e._e(),"recording"==e.nowState?r("el-button",{attrs:{type:"primary"},on:{click:e.addBrief}},[e._v(" 添加记录点 ")]):e._e(),r("el-row",{staticStyle:{padding:"2rem"}},e._l(e.recordingInfo.points,(function(t,n){return r("el-col",{key:e.formatDate(t.time),attrs:{span:8}},[r("el-button",{staticStyle:{"margin-bottom":"1rem","margin-left":"2rem"},on:{click:function(t){return e.showRecordingPoint(n)}}},[e._v(" "+e._s("title"in t.note?"笔记:"+t.note.title:"标记点:"+e.formatDate(t.time))+" ")])],1)})),1)],1):e._e()],1)],1)],1)],1):e._e(),"sm"==e.$mq?r("div",{staticClass:"phoneui"},[r("van-row",[r("van-col",{attrs:{span:"12",offset:"6"}},[r("div",{staticStyle:{"font-size":"3rem"}},[e._v(e._s(e.recordTime))])])],1),null==e.recorder?r("van-row",[r("van-button",{on:{click:function(t){e.mobile_show_selectsource=!0}}},[e._v("当前设备尚未初始化，请选择媒体完成初始化")]),r("van-popup",{style:{height:"30%"},attrs:{closeable:"","close-icon-position":"top-left",position:"bottom"},model:{value:e.mobile_show_selectsource,callback:function(t){e.mobile_show_selectsource=t},expression:"mobile_show_selectsource"}},[r("select-source",{staticStyle:{width:"100%"},attrs:{value:e.selectMediaValue},on:{"update:value":function(t){e.selectMediaValue=t},select:e.sourceSelect}})],1)],1):e._e(),r("van-row",[r("van-col",{attrs:{span:"6"}},["recording"==e.nowState?r("van-icon",{attrs:{size:"10vw",name:"flag-o"},on:{click:e.addPoint}}):e._e()],1),r("van-col",{attrs:{span:"12"}},["normal"==e.nowState||"stopped"==e.nowState?r("van-icon",{attrs:{name:"play-circle-o",size:"10vw"},on:{click:e.start}}):e._e(),"recording"==e.nowState?r("van-icon",{attrs:{name:"pause-circle-o",size:"10vw"},on:{click:e.pause}}):e._e(),"paused"==e.nowState?r("van-icon",{attrs:{name:"play-circle-o",size:"10vw"},on:{click:e.resume}}):e._e()],1),r("van-col",{attrs:{span:"6"}},["recording"==e.nowState||"paused"==e.nowState?r("van-icon",{attrs:{name:"stop-circle-o",size:"10vw"},on:{click:e.stop}}):e._e()],1)],1),r("van-cell-group",[e._v(" 这里和pc不一样 这里可以点击并弹出笔记编辑页面 "),e._l(e.recordingInfo.points,(function(t,n){return r("van-cell",{key:e.formatDate(t.time),attrs:{"is-link":"",title:t.time.toString()},on:{click:function(t){return e.mobile_editnote(n)}}})}))],2),r("van-tabbar",[r("van-tabbar-item",{attrs:{icon:"home-o"}},[e._v("录制")]),r("van-tabbar-item",{attrs:{icon:"search"}},[e._v("播放列表")]),r("van-tabbar-item",{attrs:{icon:"friends-o"}},[e._v("统计信息")]),r("van-tabbar-item",{attrs:{icon:"setting-o"}},[e._v("个人信息")])],1)],1):e._e()])},ye=[],ke=r("54f8"),Re=(r("4de4"),r("3ca3"),r("25f0"),r("caad"),r("2532"),r("a15b"),r("99af"),r("2b3d"),r("a9e3"),r("cee5")),Oe=r.n(Re),_e=r("cff8"),je=r.n(_e),Ie=r("c4e3"),Se=r.n(Ie),Ne=r("7f81"),Be=r.n(Ne),Te=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("textarea",{on:{keydown:function(t){return e.down(t)},keyup:function(t){return e.up(t)}}})])},Ee=[],Me={data:function(){return{timelist:[]}},watch:{timelist:function(){console.log(this.timelist)}},methods:{down:function(e){this.timelist.push({code:e.code,type:"down"})},up:function(e){this.timelist.push({code:e.code,type:"up"})},get:function(){return this.timelist}}},De=Me,$e=Object(d["a"])(De,Te,Ee,!1,null,"a509bd70",null),He=$e.exports,Ce=r("7d92"),Pe=r("7247"),Le=function(){function e(t){Object(z["a"])(this,e),this.store=null,this.store=Object(ae["b"])(t,t)}return Object(V["a"])(e,[{key:"entities",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.store){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Object(ae["d"])(this.store);case 4:return e.abrupt("return",e.sent.map((function(e){if(e[1]instanceof Blob)return[e[0].toString(),e[1]];throw new Error("错误，数据类型不是Blob")})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"clear",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.store){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(ae["a"])(this.store);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"count",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.store){e.next=2;break}return e.abrupt("return",0);case 2:return e.next=4,Object(ae["d"])(this.store);case 4:return e.abrupt("return",e.sent.length);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"hasBlock",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.store){e.next=8;break}return e.next=3,Object(ae["e"])(t,this.store);case 3:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0===e.t1);case 8:throw new Error("错误，没有初始化");case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getBlock",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.store){e.next=11;break}return e.next=3,Object(ae["e"])(t,this.store);case 3:if(r=e.sent,!r){e.next=8;break}return e.abrupt("return",r);case 8:throw new Error("没有这个项");case 9:e.next=12;break;case 11:throw new Error("错误，没有初始化");case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"pushBlock",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.store){e.next=5;break}return e.next=3,Object(ae["g"])(t,r,this.store);case 3:e.next=6;break;case 5:throw new Error("错误，没有初始化");case 6:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"removeBlock",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.store){e.next=5;break}return e.next=3,Object(ae["c"])(t,this.store);case 3:e.next=6;break;case 5:throw new Error("错误，没有初始化");case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Ue=(Ce["sha256"]().update("userlist").digest("hex"),function(){function e(t,r){Object(z["a"])(this,e),this.username=t,this.password=r}return Object(V["a"])(e,[{key:"login",value:function(e,t){this.password=t,this.username=e}},{key:"generate",value:function(e){return Ce["sha256"]().update("__".concat(this.username,"__").concat(this.password,"__").concat(e)).digest("hex")}},{key:"generatePublicInfoKey",value:function(e){return Ce["sha256"]().update(this.username+e).digest("hex")}},{key:"encrypto",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=new Pe["ModeOfOperation"].ctr(Pe["utils"].hex.toBytes(this.generate("encrypto"))),e.t0=r,e.next=4,t.arrayBuffer();case 4:if(e.t1=e.sent,n=e.t0.encrypt.call(e.t0,e.t1),!(n instanceof Array)){e.next=10;break}return e.abrupt("return",new Blob(n));case 10:return e.abrupt("return",new Blob([n]));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"decrypto",value:function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=new Pe["ModeOfOperation"].ctr(Pe["utils"].hex.toBytes(this.generate("encrypto"))),e.t0=r,e.next=4,t.arrayBuffer();case 4:if(e.t1=e.sent,n=e.t0.decrypt.call(e.t0,e.t1),!(n instanceof Array)){e.next=10;break}return e.abrupt("return",new Blob(n));case 10:return e.abrupt("return",new Blob([n]));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}()),Ae=r("3717"),Ye=r.n(Ae),Fe=r("f564"),ze=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["point"==e.data.type?["title"in e.data.note?[e.data.note.title==e.data.note.desc&&e.data.note.desc==e.data.note.content?[r("div",[e._v("记录点:"+e._s(e.data.note.title))])]:[r("el-collapse",[r("el-collapse-item",{attrs:{name:"笔记信息",title:"笔记信息"}},[r("el-form",[r("el-form-item",{attrs:{label:"标题"}},[r("el-input",{attrs:{value:e.data.note.title,disabled:!0,placeholder:""}})],1),r("el-form-item",{attrs:{label:"简述"}},[r("el-input",{attrs:{value:e.data.note.desc,disabled:!0,placeholder:""}})],1)],1)],1)],1),r("mavon-editor",{staticStyle:{width:"100%"},style:{height:"60vh"},attrs:{subfield:!1,defaultOpen:"preview",editable:!1,toolbars:{}},model:{value:e.data.note.content,callback:function(t){e.$set(e.data.note,"content",t)},expression:"data.note.content"}})]]:[r("div",[e._v("标记点:"+e._s(e.data.time))])]]:"pause"==e.data.type?void 0:e._e()],2)},Ve=[],qe={props:{data:{type:Object,default:{}}}},We=qe,Xe=Object(d["a"])(We,ze,Ve,!1,null,"05ba5049",null),Je=Xe.exports,Ge=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{fullscreen:"","append-to-body":"",title:"查看记录",visible:e.isShowingNote},on:{"update:visible":function(t){e.isShowingNote=t},keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.isShowingNote=!1}}},[r("show-note",{attrs:{data:e.nowShowedNote}}),r("el-divider"),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isShowingNote=!1}}},[e._v("关闭")])],1),r("el-row",{staticStyle:{padding:"2rem"}},e._l(e.points,(function(t,n){return r("el-col",{key:e.formatDate(t.time),attrs:{span:8}},[r("el-button",{staticStyle:{"margin-bottom":"1rem","margin-left":"2rem"},on:{click:function(t){return e.showRecordingPoint(n)}}},[e._v(" "+e._s("title"in t.note?"笔记:"+t.note.title:"标记点:"+e.formatDate(t.time))+" ")])],1)})),1)],1)},Ke=[],Qe={components:{ShowNote:Je},props:{points:{type:Array,default:function(){return[]}}},data:function(){return{isShowingNote:!1,nowShowedNote:{}}},methods:{formatDate:function(e){return X()(e).format("YYYY-MM-DD HH:mm:ss")},showRecordingPoint:function(e){var t=this.points[e];this.nowShowedNote=t,this.isShowingNote=!0}}},Ze=Qe,et=Object(d["a"])(Ze,Ge,Ke,!1,null,"518cba3b",null),tt=et.exports,rt=r("cc16"),nt=new Ue("gmono","gmono"),at=nt.generate("historyBlobs"),ot=nt.generate("historyBlobsInfoMap"),it=nt.generate("tempcache"),st=nt.generate("recordingInfo"),ct=new Le(it),ut="record";var lt,dt,ft={components:{TimeLineNote:He,SelectSource:S,ShowNote:Je,NoteList:tt},name:"HelloWorld",props:{msg:String},watch:{selectMediaValue:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:null!=e.recordingInfo&&(e.recordingInfo.source=e.selectMediaValue);case 1:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.brofs),console.log(e.$mq),t.prev=2,e.loading=!0,t.next=6,e.fs.ensureDir(ut);case 6:return e.loadHistoryIdx(),t.next=9,e.tempCacheEmpty();case 9:if(t.sent){t.next=17;break}return t.next=12,e.getTempRecordingInfo();case 12:r=t.sent,e.selectMediaValue=r.source,e.$nextTick(Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.startFormTempCache();case 2:case"end":return t.stop()}}),t)})))),t.next=19;break;case 17:return t.next=19,e.initRecorder();case 19:e.loading=!1,t.next=26;break;case 22:t.prev=22,t.t0=t["catch"](2),e.loading=!1,e.$message.error("获取媒体设备错误");case 26:case"end":return t.stop()}}),t,null,[[2,22]])})))()},data:function(){return{forceDownload_process:0,fs:new rt["a"],mobile_show_selectsource:!1,active:"2",selectMediaValue:"mic",videoStreamUrl:null,nowEditNote:{content:"",title:"",desc:""},nowShowedNote:{},isShowingNote:!1,noteContentVisible:!1,isNoteEditing:!1,loading:!1,player:null,recordingInfo:{recordType:"audio",source:"",points:[]},startTime:new Date,endTime:new Date,nowRecordInfo:null,blobs:[],mergedBlob:null,recorder:null,src:"",historyBlobsIdx:[],historyInfoMap:{},nowState:"normal",showPlayer:!1,stopping:!1}},computed:{recordTime:function(){return X()(0).second(this.blobs.length).subtract(8,"hours").format("HH:mm:ss")}},asyncComputed:{playList:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.historyBlobsIdx),t.next=3,Promise.all(e.historyBlobsIdx.map(function(){var t=Object(w["a"])(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.readHistoryItem(r);case 2:if(n=t.sent,n){t.next=5;break}return t.abrupt("return",void 0);case 5:return t.abrupt("return",{name:e.historyInfoMap[r].name,id:r,size:n.size,length:e.historyInfoMap[r].length,startTime:e.historyInfoMap[r].startTime});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return t.abrupt("return",t.sent.filter((function(e){return void 0!=e})));case 4:case"end":return t.stop()}}),t)})))()}},methods:{forceDownload:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fs.fs.fs,r=Object(q["a"])(),n=Ye.a.createWriteStream("forcedownload.webm"),a=n.getWriter(),t.next=6,e.$alert("紧急下载:"+r);case 6:return t.next=8,ct.count();case 8:o=t.sent,i=0;case 10:if(!(i<o)){t.next=25;break}return console.log(i),t.t0=a,t.t1=e.fs.buffer,t.next=16,ct.getBlock(i.toString());case 16:return t.next=18,t.sent.arrayBuffer();case 18:return t.t2=t.sent,t.t3=t.t1.from.call(t.t1,t.t2),t.next=22,t.t0.write.call(t.t0,t.t3);case 22:++i,t.next=10;break;case 25:return t.next=27,a.close();case 27:case"end":return t.stop()}}),t)})))()},idbHas:function(e){return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(ae["f"])();case 2:return t.abrupt("return",t.sent.includes(e));case 3:case"end":return t.stop()}}),t)})))()},get:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a,o,i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(ae["e"])(e);case 2:if(n=r.sent,void 0!=n){r.next=18;break}return r.next=7,t.fs.getAllFiles(ut);case 7:if(a=r.sent,o=a.indexOf(e),-1!=o){r.next=11;break}return r.abrupt("return",void 0);case 11:return i=a[o],r.next=14,t.fs.readFile(t.fs.path.join(ut,i));case 14:return s=r.sent,r.abrupt("return",s);case 18:return r.abrupt("return",n);case 19:case"end":return r.stop()}}),r)})))()},set:function(e,t){var r=this;return Object(w["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,r.fs.writeToFile(r.fs.path.join(ut,e),t);case 2:case"end":return n.stop()}}),n)})))()},del:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t.idbHas(e)){r.next=5;break}return r.next=3,Object(ae["c"])(e);case 3:r.next=7;break;case 5:return r.next=7,t.fs.delFile(t.fs.path.join(ut,e));case 7:case"end":return r.stop()}}),r)})))()},mobile_editnote:function(e){var t=this.recordingInfo.points[e];Object(Fe["a"])({type:"success",message:JSON.stringify(t)})},autoInit:function(){},sourceSelect:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,R(e.selectMediaValue);case 2:r=t.sent,null==r&&Object(b["error"])("此媒體源不可用"),console.log(r),""!==e.selectMediaValue&&null!=r&&e.setSource(r);case 7:case"end":return t.stop()}}),t)})))()},setSource:function(e){if(null!=e){var t=e.type,r=e.stream;this.recordingInfo&&(this.recordingInfo.source=e.name),console.log(t),"audio"===t?(this.recordingInfo.recordType="audio",this.initRecorder(r)):"video"===t&&(this.recordingInfo.recordType="video",this.initVideoRecorder(r))}else Object(b["error"])("設置的媒體源無效")},initVideoRecorder:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a,o,i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.t0=e,r.t0){r.next=5;break}return r.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:!0});case 4:r.t0=r.sent;case 5:return n=r.t0,a=t.$refs["record_video_player"],a.srcObject=n,a.play(),o=15e5,r.next=12,t.$prompt("输入总码率（单位Mbps ，推荐1.5）:");case 12:i=r.sent,"confirm"==i.action&&(o=1e3*parseInt(i.value)*1e3),s=new MediaRecorder(n,{bitsPerSecond:o,audioBitrateMode:"variable",mimeType:"video/webm;codecs=vp9"}),s.ondataavailable=function(e){return t.dataavailable(e)},t.recorder=s;case 17:case"end":return r.stop()}}),r)})))()},initRecorder:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.t0=e,r.t0){r.next=5;break}return r.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 4:r.t0=r.sent;case 5:return n=r.t0,a=128e3,r.next=9,t.$prompt("输入音频码率（单位 kbps,推荐128）:");case 9:o=r.sent,"confirm"==o.action&&(a=1e3*parseInt(o.value)),i=new MediaRecorder(n,{bitsPerSecond:a,audioBitrateMode:"variable",mimeType:"audio/webm;codecs:opus"}),i.ondataavailable=function(e){return t.dataavailable(e)},t.recorder=i;case 14:case"end":return r.stop()}}),r)})))()},note_inputcontent:function(){this.noteContentVisible=!0},filesize:function(e){return Oe()(e)},show_player:function(){this.showPlayer=!0},createPoint:function(e,t){var r=this.blobs.length,n=new Date;return{type:e,note:t,position:r,time:n}},formatDate:function(e){return X()(e).format("YYYY-MM-DD HH:mm:ss")},secondToTime:function(e){return X()(0).second(e).subtract(8,"hours").format("HH:mm:ss")},info_generate:function(e){var t=[],r=this.historyInfoMap[e];for(var n in r){var a="startTime"==n||"endTime"==n?this.formatDate(r[n]):"length"==n?this.secondToTime(r[n]):r[n];t.push("".concat(n,"：").concat(a))}return t},playlist_del:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.historyInfoMap[e],r.next=3,t.$confirm("是否要删除:"+n.name+"?");case 3:if(a=r.sent,"confirm"!=a){r.next=8;break}return null!=t.nowRecordInfo&&e==t.nowRecordInfo.id&&t.clearNow(),r.next=8,t.removeItem(e);case 8:case"end":return r.stop()}}),r)})))()},playlist_download:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.historyInfoMap[e],t.$message.info("已开始下载："+n.name),r.t0=URL,r.next=5,t.readHistoryItem(e);case 5:return r.t1=r.sent,a=r.t0.createObjectURL.call(r.t0,r.t1),o=URL.createObjectURL(new Blob([JSON.stringify(n)])),r.next=10,t.downloadUrl(n.name+".webm",a);case 10:return URL.revokeObjectURL(a),r.next=13,t.downloadUrl(n.name+".json",o);case 13:URL.revokeObjectURL(n);case 14:case"end":return r.stop()}}),r)})))()},playlist_rename:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$prompt("请输入名称:","命名录音",{showCancelButton:!1,inputValue:t.historyInfoMap[e].name});case 2:if(n=r.sent,"confirm"!=n.action){r.next=8;break}return r.next=6,t.renameItem(e,n.value);case 6:r.next=10;break;case 8:return r.next=10,t.$alert("错误");case 10:case"end":return r.stop()}}),r)})))()},addPoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.createPoint("point",e);this.recordingInfo.points.push(t)},addNote:function(){this.isNoteEditing=!0},addBrief:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$prompt("输入记录描述(tips):","添加记录点");case 2:r=t.sent,"confirm"==r.action?(e.nowEditNote.title=r.value,e.nowEditNote.desc=r.value,e.nowEditNote.content=r.value,e.addPoint(e.nowEditNote),e.clearNowEditNote()):e.clearNowEditNote();case 4:case"end":return t.stop()}}),t)})))()},clearNowEditNote:function(){this.nowEditNote={title:"",desc:"",content:""}},note_confirm:function(){this.addPoint(this.nowEditNote),this.isNoteEditing=!1,this.clearNowEditNote()},onnote_cancel:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("不保存笔记？");case 2:n=r.sent,"confirm"==n&&(t.clearNowEditNote(),e());case 4:case"end":return r.stop()}}),r)})))()},note_cancel:function(){var e=this;this.onnote_cancel((function(){e.isNoteEditing=!1}))},showRecordingPoint:function(e){var t=this.recordingInfo.points[e];this.nowShowedNote=t,this.isShowingNote=!0},play:function(){this.showPlayer=!0;var e=this.$refs.player;e.play()},play_pause:function(){var e=this.$refs.player;e.pause()},play_stop:function(){var e=this.$refs.player;e.fastSeek(0),this.play_pause()},select:function(e){var t=this;console.log(e),"recording"!=this.nowState&&"paused"!=this.nowState?(this.clearNow(),this.readHistoryItem(e).then((function(r){t.loadNow(e,r)}))):this.$message.error("不能在录音时进行播放，请先停止录音")},stateSwitch:function(e){this.nowState=e},dataavailable:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t.stopping){r.next=2;break}return r.abrupt("return");case 2:return n=t.stopping,t.stopping&&(t.stopping=!1),t.blobs.push(e.data),t.endTime=new Date,console.log(e),r.next=9,t.addRecordFrame(e.data);case 9:return r.next=11,t.storeRecording();case 11:if(!n){r.next=14;break}return r.next=14,t.stop_after();case 14:case"end":return r.stop()}}),r)})))()},start:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.clearNow(),e.startTime=new Date,e.endTime=new Date,e.recorder.start(1e3),t.next=6,e.storeRecording();case 6:e.stateSwitch("recording");case 7:case"end":return t.stop()}}),t)})))()},getTempRecordingInfo:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,je.a.get(st);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))()},startFormTempCache:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.tempCacheEmpty();case 2:if(!t.sent){t.next=4;break}throw new Error("不存在上次记录");case 4:return t.next=6,e.loadTempCache();case 6:return e.blobs=t.sent,t.next=9,je.a.get(st);case 9:r=t.sent,e.startTime=r["startTime"],e.endTime=r["endTime"],e.recordingInfo.points=r["points"],console.log(e.recorder),e.loading=!0,e.$watch("recorder",(function(){e.recorder&&(e.recorder.start(1e3),e.stateSwitch("recording"),e.pause()),e.loading=!1}),{immediate:!0});case 16:case"end":return t.stop()}}),t)})))()},storeRecording:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,je.a.set(st,Object(i["a"])({startTime:e.startTime,endTime:e.endTime},e.recordingInfo));case 2:case"end":return t.stop()}}),t)})))()},addRecordFrame:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.blobs.length-1,r.next=3,ct.pushBlock(n.toString(),e);case 3:case"end":return r.stop()}}),r)})))()},resume:function(){var e=this.recorder;e.resume(),this.stateSwitch("recording")},pause:function(){var e=this.recorder;e.pause(),this.stateSwitch("paused")},clearTempCache:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ct.clear();case 2:case"end":return e.stop()}}),e)})))()},tempCacheEmpty:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ct.getBlock(Number(0).toString());case 2:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0==e.t1);case 5:case"end":return e.stop()}}),e)})))()},loadTempCache:function(){return Object(w["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ct.entities();case 2:return t=e.sent,t=t.sort((function(e,t){e[0],t[0]})),r=t.map((function(e){return e[1]})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))()},stop:function(){var e=this;this.recorder.stop(),this.stopping=!0,this.stop_after().then((function(){e.stopping=!1}))},stop_after:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(b["delay"])(0);case 2:return e.stateSwitch("merging"),e.mergeBlobs(e.blobs),e.pushToHistory(),t.next=7,e.clearTempCache();case 7:return e.stateSwitch("stopped"),r=e.nowRecordInfo.id,t.prev=9,t.next=12,e.$prompt("请输入名称:","命名录音",{showCancelButton:!1,inputValue:r,closeOnClickModal:!1,closeOnPressEscape:!1,closeOnHashChange:!1});case 12:if(n=t.sent,"confirm"!=n.action){t.next=16;break}return t.next=16,e.renameItem(e.nowRecordInfo.id,n.value);case 16:t.next=20;break;case 18:t.prev=18,t.t0=t["catch"](9);case 20:return t.t1=e,t.t2=r,t.next=24,e.readHistoryItem(r);case 24:t.t3=t.sent,t.t1.loadNow.call(t.t1,t.t2,t.t3);case 26:case"end":return t.stop()}}),t,null,[[9,18]])})))()},download:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""==e.src){t.next=7;break}return e.$message.info("已开始下载："+e.nowRecordInfo.name),e.downloadUrl(e.nowRecordInfo.name+".webm",e.src),r=URL.createObjectURL(new Blob([JSON.stringify(e.nowRecordInfo)])),t.next=6,e.downloadUrl(e.nowRecordInfo.name+".json",r);case 6:URL.revokeObjectURL(r);case 7:case"end":return t.stop()}}),t)})))()},downloadAll:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.$message.warning({message:"正在顺序下载所有内容",duration:0,showClose:!0}),n=Object(ke["a"])(e.historyBlobsIdx),t.prev=2,n.s();case 4:if((a=n.n()).done){t.next=10;break}return o=a.value,t.next=8,e.playlist_download(o);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:r.close();case 19:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))()},downloadAll_packed:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,i,s,c,u,l,d,f,p,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("zip压缩下载有总大小限制，可能导致失败与卡顿，确定使用此方式下载吗（可选择专用格式）？");case 2:if(r=t.sent,"confirm"==r){t.next=5;break}return t.abrupt("return");case 5:n=e.$message.warning({message:"正在打包......",duration:0,showClose:!0}),a=new Se.a,o=e.historyBlobsIdx,i=Object(ke["a"])(o),t.prev=10,i.s();case 12:if((s=i.n()).done){t.next=24;break}return c=s.value,u=a.folder(c),l=e.historyInfoMap[c],t.next=18,e.readHistoryItem(c);case 18:d=t.sent,u.file("".concat(c,".json"),Object(b["json"])(l)),u.file("".concat(c,".webm"),d),n.message="加入记录:".concat(c);case 22:t.next=12;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t["catch"](10),i.e(t.t0);case 29:return t.prev=29,i.f(),t.finish(29);case 32:return n.message="记录加入完成，正在进行压缩......",f=e.$message.info({message:"进度:0",duration:0,showClose:!1}),t.next=36,a.generateAsync({type:"blob",compression:"STORE"},(function(e){f.message="进度:".concat(e.percent," \n 已压缩:").concat(e.currentFile)}));case 36:return p=t.sent,m=URL.createObjectURL(p),n.close(),e.$message.warning("已经开始下载打包文件"),t.next=42,e.downloadUrl("packageRecords.zip",m);case 42:URL.revokeObjectURL(m);case 43:case"end":return t.stop()}}),t,null,[[10,26,29,32]])})))()},downloadAll_packed_private:function(){this.$msgbox("尚未实现此功能，敬请期待")},removeNow:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.playlist_del(e.nowRecordInfo.id);case 2:case"end":return t.stop()}}),t)})))()},clear:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("确定要清除所有记录吗?",{type:"warning"});case 2:r=t.sent,"confirm"==r&&e.clearHistroy();case 4:case"end":return t.stop()}}),t)})))()},downloadUrl:function(e,t){return Object(w["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=new Be.a({url:t,filename:e}),r.next=3,n;case 3:case"end":return r.stop()}}),r)})))()},mergeBlobs:function(e){var t=new Blob(e,{type:"audio/webm"});this.src=URL.createObjectURL(t),this.mergedBlob=t;var r="record_".concat(X()(this.startTime).format("YYYY-MM-DD hh:mm:ss"),"_").concat(X()(this.endTime).format("YYYY-MM-DD hh:mm:ss"));this.nowRecordInfo=Object(i["a"])({name:r,id:r,startTime:this.startTime,endTime:this.endTime,timeSpanList:[],length:e.length},this.recordingInfo)},clearNow:function(){null!=this.src&&""!=this.src&&(URL.revokeObjectURL(this.src),this.src="",this.mergedBlob=null,this.blobs=[],this.nowRecordInfo=null,this.recordingInfo.points=[])},loadNow:function(e,t){this.clearNow(),this.mergedBlob=t,this.blobs=[],this.nowRecordInfo=this.historyInfoMap[e],this.src=URL.createObjectURL(t)},pushToHistory:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(-1==e.historyBlobsIdx.indexOf(e.nowRecordInfo.id)){t.next=2;break}throw new Error("已经存在同名历史记录");case 2:if(null!=e.mergedBlob&&null!=e.nowRecordInfo.id){t.next=4;break}throw new Error("错误调用");case 4:return t.next=6,e.addItem(e.nowRecordInfo,e.mergedBlob);case 6:case"end":return t.stop()}}),t)})))()},addItem:function(e,t){var r=this;return Object(w["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r.historyBlobsIdx.push(e.id),je()(at,r.historyBlobsIdx),r.historyInfoMap[e.id]=e,je()(ot,r.historyInfoMap),n.next=6,r.set(at+e.id,t);case 6:case"end":return n.stop()}}),n)})))()},loadHistoryIdx:function(){je.a.has(at)?this.historyBlobsIdx=je.a.get(at):this.historyBlobsIdx=[],je.a.has(ot)?this.historyInfoMap=je.a.get(ot):this.historyInfoMap={}},clearHistroy:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=Object(ke["a"])(e.historyBlobsIdx),t.prev=1,r.s();case 3:if((n=r.n()).done){t.next=9;break}return a=n.value,t.next=7,e.del(at+a);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),r.e(t.t0);case 14:return t.prev=14,r.f(),t.finish(14);case 17:je.a.remove(at),je.a.remove(ot),e.clearNow(),e.loadHistoryIdx();case 21:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})))()},readHistoryItem:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(-1!=t.historyBlobsIdx.indexOf(e)){r.next=2;break}throw new Error("记录"+e+"不存在");case 2:return r.next=4,t.get(at+e);case 4:return n=r.sent,r.abrupt("return",n);case 6:case"end":return r.stop()}}),r)})))()},removeItem:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(-1!=t.historyBlobsIdx.indexOf(e)){r.next=2;break}throw new Error("没有这个记录");case 2:return t.historyBlobsIdx=t.historyBlobsIdx.filter((function(t){return t!=e})),delete t.historyInfoMap[e],je.a.set(ot,t.historyInfoMap),je.a.set(at,t.historyBlobsIdx),r.next=8,t.del(at+e);case 8:case"end":return r.stop()}}),r)})))()},renameItem:function(e,t){var r=this;return Object(w["a"])(regeneratorRuntime.mark((function n(){var a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(-1!=r.historyBlobsIdx.indexOf(e)){n.next=2;break}throw new Error("没有这个记录");case 2:return n.next=4,r.readHistoryItem(e);case 4:return a=n.sent,o=r.historyInfoMap[e],n.next=8,r.removeItem(e);case 8:return o.name=t,n.next=11,r.addItem(o,a);case 11:case"end":return n.stop()}}),n)})))()}}},pt=ft,mt=(r("7863"),Object(d["a"])(pt,xe,ye,!1,null,"22070e65",null)),ht=mt.exports,wt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("ul",e._l(e.historyInfos,(function(t,n){return r("li",{key:n},[e._v(e._s(JSON.stringify(t)))])})),0),e._v(" "+e._s(e.recordingLength)+" "),r("el-button",{on:{click:e.startNew}},[e._v("开始")]),r("el-button",{on:{click:e.resume}},[e._v("继续")]),r("el-button",{on:{click:e.pause}},[e._v("暂停")]),r("el-button",{on:{click:function(t){return e.saveRecording()}}},[e._v("开始")])],1)},bt=[],vt={data:function(){return{}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ensureInitHistory();case 2:case"end":return t.stop()}}),t)})))()},computed:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(F["d"])("recorder",["recordingLength"])),Object(F["d"])("history",["historyIdxs"])),Object(F["e"])("history",["historyInfos"])),methods:Object(i["a"])(Object(i["a"])({},Object(F["c"])("recorder",["startNew","pause","saveRecording","resume"])),Object(F["c"])("history",["ensureInitHistory"]))},gt=vt,xt=Object(d["a"])(gt,wt,bt,!1,null,"402d414c",null),yt=xt.exports,kt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v(" "+e._s(e.countA)+" "+e._s(e.hello)+" "),r("el-button",{attrs:{type:"primary"},on:{click:e.test}},[e._v("+1")]),r("div",[e._v(" "+e._s(e.countAdd)+" ")])],1)},Rt=[],Ot=r("2c4c"),_t=r("920b"),jt=r("92a6"),It=r("2fe1"),St=(lt=Object(It["b"])({computed:Object(i["a"])(Object(i["a"])({},Object(F["e"])(["countA"])),{},{hello:function(){return this.countAdd+this.$store.state.countA}})}),lt(dt=function(e){Object(_t["a"])(r,e);var t=Object(jt["a"])(r);function r(){var e;Object(z["a"])(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),Object(ne["a"])(Object(Ot["a"])(e),"count",0),e}return Object(V["a"])(r,[{key:"countAdd",get:function(){return this.count+1}},{key:"test",value:function(){this.count++,this.$store.commit("increment")}},{key:"mounted",value:function(){alert("hello")}}]),r}(n["default"]))||dt),Nt=St,Bt=Nt,Tt=Object(d["a"])(Bt,kt,Rt,!1,null,"b151066e",null),Et=Tt.exports,Mt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("AuthingGuard",{attrs:{appId:"60ace8a7de8081b582bbaf6e"},on:{login:e.login}})],1)},Dt=[],$t=r("8c7e"),Ht=(r("c2ad"),{components:{AuthingGuard:$t["AuthingGuard"]},methods:{login:function(e){console.log(e),this.$router.push({path:"/"})}}}),Ct=Ht,Pt=Object(d["a"])(Ct,Mt,Dt,!1,null,"76c495ac",null),Lt=Pt.exports,Ut=r("b2d8"),At=r.n(Ut),Yt=(r("64e1"),r("660e")),Ft=r("a925"),zt=r("187c");n["default"].config.productionTip=!1,n["default"].use(H),n["default"].use(C["a"]),n["default"].use(P["a"]),n["default"].use(A["a"]),n["default"].use(F["b"]);var Vt=ve();n["default"].use(ge["a"]);var qt=[{path:"/login",component:Lt},{path:"/",component:ht},{path:"/center",component:Et},{path:"/new",component:yt}],Wt=new ge["a"]({routes:qt});n["default"].use(U.a,{name:"ls",bind:!0}),n["default"].use(At.a),n["default"].use(Ft["a"]),n["default"].use(Yt["a"],{breakpoints:{sm:450,md:950,lg:1/0},defaultBreakpoint:"sm"});var Xt=document.getElementById("cont");zt["install"](window),zt["configure"]({fs:zt["FileSystem"].IndexedDB.Name,options:{}},(function(e){if(e)throw e;new n["default"]({render:function(e){return e($)},store:Vt,router:Wt,el:Xt})}))}});
//# sourceMappingURL=app.952799d4.js.map